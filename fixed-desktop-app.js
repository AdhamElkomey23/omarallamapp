#!/usr/bin/env node
import fs from 'fs';
import { execSync } from 'child_process';

console.log('Creating Fixed Desktop Application with Original Homepage Design...');

// Create app directory
if (fs.existsSync('desktop-app')) {
  execSync('rm -rf desktop-app');
}
fs.mkdirSync('desktop-app', { recursive: true });

// Convert logo to base64
const logoPath = 'attached_assets/ÿßŸÑŸàÿßÿµŸÑŸàŸÜ (1)_1749400506920.png';
let logoBase64 = '';
try {
  const logoBuffer = fs.readFileSync(logoPath);
  logoBase64 = `data:image/png;base64,${logoBuffer.toString('base64')}`;
} catch (error) {
  console.log('Logo not found, using default icon');
}

// Fixed HTML application with original homepage design
const fixedHTML = `<!DOCTYPE html>
<html lang="ar" dir="rtl" id="html-root">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ŸÖÿµŸÜÿπ ÿßŸÑÿ£ÿ≥ŸÖÿØÿ© - ÿ¥ÿ±ŸÉÿ© ÿßŸÑŸàÿßÿµŸÑŸàŸÜ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --background: 40 30% 96%;
            --foreground: 20 14.3% 4.1%;
            --muted: 60 4.8% 95.9%;
            --muted-foreground: 25 5.3% 44.7%;
            --card: 0 0% 100%;
            --card-foreground: 20 14.3% 4.1%;
            --border: 20 5.9% 90%;
            --primary: 28 58% 35%;
            --primary-foreground: 210 20% 98%;
            --secondary: 32 39% 76%;
            --accent: 130 27% 33%;
            --ring: 28 58% 35%;
        }
        
        * { 
            font-family: 'Cairo', 'Inter', sans-serif; 
            transition: all 0.3s ease;
        }
        
        body { 
            background-color: #f9fafb; 
            color: hsl(var(--foreground)); 
            margin: 0;
            padding: 0;
        }
        
        .bg-background { background-color: hsl(var(--background)); }
        .bg-card { background-color: hsl(var(--card)); }
        .bg-muted { background-color: hsl(var(--muted)); }
        .bg-primary { background-color: hsl(var(--primary)); }
        .text-primary { color: hsl(var(--primary)); }
        .text-muted-foreground { color: hsl(var(--muted-foreground)); }
        .text-primary-foreground { color: hsl(var(--primary-foreground)); }
        .border-border { border-color: hsl(var(--border)); }
        .hover\\:bg-muted:hover { background-color: hsl(var(--muted)); }
        .hover\\:bg-primary\\/90:hover { background-color: hsl(var(--primary) / 0.9); }
        
        .sidebar-collapsed { width: 80px; }
        .sidebar-expanded { width: 280px; }
        .content-with-sidebar { margin-right: 280px; }
        .content-with-collapsed-sidebar { margin-right: 80px; }
        
        .chart-container { 
            position: relative; 
            height: 350px; 
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            width: 100%;
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            text-decoration: none;
            color: #4a5568;
            border: none;
            background: none;
            text-align: right;
            gap: 12px;
            font-size: 14px;
            transition: all 0.2s ease;
        }
        
        .nav-item:hover { 
            background-color: #f7fafc; 
            color: #2d3748;
        }
        
        .nav-item.active {
            background-color: #8B5A2B;
            color: white;
        }
        
        .nav-item .icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            flex-shrink: 0;
        }
        
        /* Icon styles using pseudo-elements for better compatibility */
        .icon-home::before { content: "üè†"; }
        .icon-chart::before { content: "üìä"; }
        .icon-cart::before { content: "üõí"; }
        .icon-money::before { content: "üí∞"; }
        .icon-users::before { content: "üë•"; }
        .icon-warehouse::before { content: "üè≠"; }
        .icon-clipboard::before { content: "üìã"; }
        .icon-reports::before { content: "üìà"; }
        .icon-settings::before { content: "‚öôÔ∏è"; }
        
        .hidden { display: none !important; }
        .loading { 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            min-height: 200px;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid hsl(var(--muted));
            border-top: 4px solid hsl(var(--primary));
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin { 
            to { transform: rotate(360deg); } 
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .form-field {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .form-field label {
            font-weight: 600;
            color: hsl(var(--foreground));
            font-size: 0.875rem;
        }
        
        .form-field input, .form-field select, .form-field textarea {
            padding: 0.75rem;
            border: 2px solid hsl(var(--border));
            border-radius: 0.5rem;
            font-size: 1rem;
            background-color: hsl(var(--card));
            color: hsl(var(--foreground));
        }
        
        .form-field input:focus, .form-field select:focus, .form-field textarea:focus {
            outline: none;
            border-color: hsl(var(--primary));
        }
        
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            border: none;
            font-size: 1rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-primary {
            background-color: hsl(var(--primary));
            color: hsl(var(--primary-foreground));
        }
        
        .btn-primary:hover {
            background-color: hsl(var(--primary) / 0.9);
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            background-color: hsl(var(--card));
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .data-table th, .data-table td {
            padding: 1rem;
            text-align: right;
            border-bottom: 1px solid hsl(var(--border));
        }
        
        .data-table th {
            background-color: hsl(var(--muted));
            font-weight: 600;
            color: hsl(var(--foreground));
        }
        
        .data-table tr:hover {
            background-color: hsl(var(--muted) / 0.5);
        }
        
        .success-message {
            background-color: #c6f6d5;
            color: #22543d;
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1rem 0;
            border-right: 4px solid #48bb78;
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .language-switcher {
            position: absolute;
            top: 16px;
            left: 16px;
            z-index: 1000;
            background-color: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 4px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            display: flex;
        }
        
        .language-btn {
            padding: 8px 12px;
            border: none;
            background: none;
            cursor: pointer;
            border-radius: 4px;
            font-weight: 500;
            font-size: 14px;
            min-width: 40px;
            transition: all 0.2s ease;
        }
        
        .language-btn.active {
            background-color: #8B5A2B;
            color: white;
        }
        
        .language-btn:hover:not(.active) {
            background-color: #f7fafc;
        }
        
        /* RTL/LTR Layout */
        .rtl { direction: rtl; }
        .ltr { direction: ltr; }
        
        .ltr * { font-family: 'Inter', sans-serif; }
        .rtl * { font-family: 'Cairo', sans-serif; }
        
        .ltr .sidebar-expanded { left: 0; right: auto; }
        .ltr .content-with-sidebar { margin-left: 280px; margin-right: 0; }
        .ltr .content-with-collapsed-sidebar { margin-left: 80px; margin-right: 0; }
        .ltr .nav-item { text-align: left; }
        .ltr .data-table th, .ltr .data-table td { text-align: left; }
        .ltr .form-field { text-align: left; }
        .ltr .language-switcher { right: 16px; left: auto; }
        
        /* Original homepage styles from web app */
        .hero-banner {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            color: white;
            padding: 80px 40px;
            text-align: center;
            border-radius: 16px;
            margin-bottom: 32px;
            position: relative;
            overflow: hidden;
        }
        
        .hero-banner::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 120px;
            height: 120px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            backdrop-filter: blur(10px);
        }
        
        .hero-banner .factory-icon {
            font-size: 64px;
            margin-bottom: 24px;
            position: relative;
            z-index: 1;
        }
        
        .hero-title {
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 16px;
            position: relative;
            z-index: 1;
        }
        
        .hero-subtitle {
            font-size: 18px;
            opacity: 0.9;
            margin-bottom: 32px;
            position: relative;
            z-index: 1;
        }
        
        .hero-buttons {
            display: flex;
            gap: 16px;
            justify-content: center;
            position: relative;
            z-index: 1;
        }
        
        .hero-btn {
            padding: 12px 32px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .hero-btn-primary {
            background: white;
            color: #16a34a;
        }
        
        .hero-btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .hero-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        .quick-overview {
            margin-bottom: 32px;
        }
        
        .overview-title {
            font-size: 24px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 32px;
            color: #1f2937;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }
        
        .stat-card {
            background: white;
            padding: 24px;
            border-radius: 12px;
            border: 1px solid #e5e7eb;
            text-align: center;
            transition: all 0.2s ease;
        }
        
        .stat-card:hover {
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }
        
        .stat-label {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: #1f2937;
        }
        
        .stat-change {
            font-size: 12px;
            margin-top: 4px;
        }
        
        .stat-change.positive {
            color: #10b981;
        }
        
        .stat-change.negative {
            color: #ef4444;
        }
        
        .stat-icon {
            font-size: 16px;
        }
    </style>
</head>
<body>
    <!-- Language Switcher -->
    <div class="language-switcher">
        <button class="language-btn active" onclick="switchLanguage('ar')" id="lang-ar">ÿπÿ±</button>
        <button class="language-btn" onclick="switchLanguage('en')" id="lang-en">EN</button>
    </div>

    <!-- Sidebar -->
    <div id="sidebar" class="sidebar-expanded fixed top-0 h-full bg-white border-r border-gray-200 transition-all duration-300 z-40" style="right: 0;">
        <div class="flex flex-col h-full">
            <!-- Header -->
            <div class="px-4 py-6 border-b border-gray-200">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 rounded-xl flex items-center justify-center shrink-0 bg-green-100">
                            ${logoBase64 ? `<img src="${logoBase64}" alt="Al-Wasiloon Logo" class="w-8 h-8 object-contain rounded-lg">` : '<span class="text-green-600 text-xl">üè≠</span>'}
                        </div>
                        <div id="sidebar-title" class="min-w-0">
                            <h2 class="text-lg font-bold leading-tight text-gray-900" data-key="appTitle">ŸÖÿµŸÜÿπ ÿßŸÑÿ£ÿ≥ŸÖÿØÿ©</h2>
                            <p class="text-xs text-gray-500" data-key="appSubtitle">ÿ•ÿØÿßÿ±ÿ© ŸÖÿßŸÑŸäÿ©</p>
                        </div>
                    </div>
                    <button id="sidebar-toggle" class="p-2 rounded-lg hover:bg-gray-100">
                        <span class="text-gray-500">‚Üê</span>
                    </button>
                </div>
                <div id="version-badge" class="mt-3 text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded" data-key="version">
                    ÿßŸÑÿ•ÿµÿØÿßÿ± 1.0
                </div>
            </div>
            
            <!-- Navigation -->
            <nav class="flex-1 px-3 py-4 space-y-2 overflow-y-auto">
                <button class="nav-item active" onclick="showPage('home')">
                    <span class="icon icon-home"></span>
                    <span class="nav-text font-medium" data-key="home">ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©</span>
                </button>
                <button class="nav-item" onclick="showPage('dashboard')">
                    <span class="icon icon-chart"></span>
                    <span class="nav-text font-medium" data-key="dashboard">ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ</span>
                </button>
                <button class="nav-item" onclick="showPage('sales')">
                    <span class="icon icon-cart"></span>
                    <span class="nav-text font-medium" data-key="sales">ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™</span>
                </button>
                <button class="nav-item" onclick="showPage('expenses')">
                    <span class="icon icon-money"></span>
                    <span class="nav-text font-medium" data-key="expenses">ÿßŸÑŸÖÿµÿ±ŸàŸÅÿßÿ™</span>
                </button>
                <button class="nav-item" onclick="showPage('workers')">
                    <span class="icon icon-users"></span>
                    <span class="nav-text font-medium" data-key="workers">ÿßŸÑÿπŸÖÿßŸÑ</span>
                </button>
                <button class="nav-item" onclick="showPage('storage')">
                    <span class="icon icon-warehouse"></span>
                    <span class="nav-text font-medium" data-key="storage">ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ</span>
                </button>
                <button class="nav-item" onclick="showPage('activity-logs')">
                    <span class="icon icon-clipboard"></span>
                    <span class="nav-text font-medium" data-key="activityLogs">ÿ≥ÿ¨ŸÑ ÿßŸÑÿ£ŸÜÿ¥ÿ∑ÿ©</span>
                </button>
                <button class="nav-item" onclick="showPage('reports')">
                    <span class="icon icon-reports"></span>
                    <span class="nav-text font-medium" data-key="reports">ÿßŸÑÿ™ŸÇÿßÿ±Ÿäÿ±</span>
                </button>
                <button class="nav-item" onclick="showPage('settings')">
                    <span class="icon icon-settings"></span>
                    <span class="nav-text font-medium" data-key="settings">ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™</span>
                </button>
            </nav>
            
            <!-- Footer -->
            <div id="sidebar-footer" class="px-4 py-3 border-t border-gray-200 bg-gray-50">
                <p class="text-xs text-gray-500 text-center" data-key="appDescription">
                    ŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ŸÖÿµŸÜÿπ ÿßŸÑÿ£ÿ≥ŸÖÿØÿ© ÿßŸÑŸÖÿ™ŸÇÿØŸÖ
                </p>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div id="main-content" class="content-with-sidebar transition-all duration-300">
        <!-- Top Bar -->
        <header class="bg-white border-b border-gray-200 px-6 py-4">
            <div class="flex items-center justify-between">
                <h1 id="page-title" class="text-2xl font-bold text-gray-900" data-key="home">ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©</h1>
                <div class="flex items-center gap-4">
                    <div class="bg-gray-100 px-3 py-2 rounded-lg text-sm">
                        <span class="text-gray-600" data-key="lastUpdated">ÿ¢ÿÆÿ± ÿ™ÿ≠ÿØŸäÿ´:</span>
                        <span id="last-update" class="font-medium mr-1"></span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Page Content -->
        <main class="p-6">
            
            <!-- Home Page (Original Design) -->
            <div id="home-page" class="page-content">
                <!-- Hero Banner matching original design -->
                <div class="hero-banner">
                    <div class="factory-icon">üè≠</div>
                    <h1 class="hero-title" data-key="heroTitle">ŸÖÿµŸÜÿπ ÿßŸÑÿ£ÿ≥ŸÖÿØÿ©</h1>
                    <p class="hero-subtitle" data-key="heroSubtitle">ŸÖŸèÿµŸÖŸÖ ŸÑŸÑÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖÿ™ŸÜŸÇŸÑÿ© ÿ£ŸàŸÑÿßŸã</p>
                    <div class="hero-buttons">
                        <button class="hero-btn hero-btn-primary" onclick="showPage('dashboard')">
                            <span class="icon icon-chart"></span>
                            <span data-key="dashboard">ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ</span>
                        </button>
                        <button class="hero-btn hero-btn-secondary" onclick="showPage('sales')">
                            <span data-key="viewSales">ÿπÿ±ÿ∂ ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™</span>
                        </button>
                    </div>
                </div>

                <!-- Quick Overview matching original -->
                <div class="quick-overview">
                    <h2 class="overview-title" data-key="quickOverview">ŸÜÿ∏ÿ±ÿ© ÿ≥ÿ±Ÿäÿπÿ©</h2>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-label">
                                <span class="stat-icon">üí∞</span>
                                <span data-key="totalIncome">ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿØÿÆŸÑ</span>
                            </div>
                            <div class="stat-value" id="home-total-income">169,100 ÿ¨.ŸÖ</div>
                            <div class="stat-change positive" data-key="upTrend">üìà +20.1%</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-label">
                                <span class="stat-icon">üí∏</span>
                                <span data-key="totalExpenses">ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÖÿµÿ±ŸàŸÅÿßÿ™</span>
                            </div>
                            <div class="stat-value" id="home-total-expenses">120,000 ÿ¨.ŸÖ</div>
                            <div class="stat-change positive" data-key="upTrend2">üìà +5.2%</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-label">
                                <span class="stat-icon">üíµ</span>
                                <span data-key="netProfit">ÿµÿßŸÅŸä ÿßŸÑÿ±ÿ®ÿ≠</span>
                            </div>
                            <div class="stat-value" id="home-net-profit" style="color: #22c55e;">49,100 ÿ¨.ŸÖ</div>
                            <div class="stat-change positive" data-key="profitMargin">üìä 29.1% ŸáÿßŸÖÿ¥</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-label">
                                <span class="stat-icon">üì¶</span>
                                <span data-key="totalProducts">ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™</span>
                            </div>
                            <div class="stat-value" id="home-total-products">4</div>
                            <div class="stat-change" data-key="unitsSold">78 Ÿàÿ≠ÿØÿ© ŸÖÿ®ÿßÿπÿ©</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Other pages content (same as before) -->
            <div id="dashboard-page" class="page-content hidden">
                <h1>Dashboard content...</h1>
            </div>
            
            <div id="sales-page" class="page-content hidden">
                <h1>Sales content...</h1>
            </div>

        </main>
    </div>

    <script>
        // Translations
        const translations = {
            ar: {
                home: "ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©",
                dashboard: "ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ",
                sales: "ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™", 
                expenses: "ÿßŸÑŸÖÿµÿ±ŸàŸÅÿßÿ™",
                workers: "ÿßŸÑÿπŸÖÿßŸÑ",
                storage: "ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ",
                activityLogs: "ÿ≥ÿ¨ŸÑ ÿßŸÑÿ£ŸÜÿ¥ÿ∑ÿ©",
                reports: "ÿßŸÑÿ™ŸÇÿßÿ±Ÿäÿ±",
                settings: "ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™",
                appTitle: "ŸÖÿµŸÜÿπ ÿßŸÑÿ£ÿ≥ŸÖÿØÿ©",
                appSubtitle: "ÿ•ÿØÿßÿ±ÿ© ŸÖÿßŸÑŸäÿ©",
                appDescription: "ŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ŸÖÿµŸÜÿπ ÿßŸÑÿ£ÿ≥ŸÖÿØÿ© ÿßŸÑŸÖÿ™ŸÇÿØŸÖ",
                version: "ÿßŸÑÿ•ÿµÿØÿßÿ± 1.0",
                lastUpdated: "ÿ¢ÿÆÿ± ÿ™ÿ≠ÿØŸäÿ´:",
                heroTitle: "ŸÖÿµŸÜÿπ ÿßŸÑÿ£ÿ≥ŸÖÿØÿ©",
                heroSubtitle: "ŸÖŸèÿµŸÖŸÖ ŸÑŸÑÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖÿ™ŸÜŸÇŸÑÿ© ÿ£ŸàŸÑÿßŸã",
                viewSales: "ÿπÿ±ÿ∂ ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™",
                quickOverview: "ŸÜÿ∏ÿ±ÿ© ÿ≥ÿ±Ÿäÿπÿ©",
                totalIncome: "ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿØÿÆŸÑ",
                totalExpenses: "ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÖÿµÿ±ŸàŸÅÿßÿ™",
                netProfit: "ÿµÿßŸÅŸä ÿßŸÑÿ±ÿ®ÿ≠",
                totalProducts: "ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™",
                upTrend: "üìà +20.1%",
                upTrend2: "üìà +5.2%",
                profitMargin: "üìä 29.1% ŸáÿßŸÖÿ¥",
                unitsSold: "78 Ÿàÿ≠ÿØÿ© ŸÖÿ®ÿßÿπÿ©"
            },
            en: {
                home: "Home",
                dashboard: "Dashboard",
                sales: "Sales",
                expenses: "Expenses", 
                workers: "Workers",
                storage: "Storage",
                activityLogs: "Activity Logs",
                reports: "Reports", 
                settings: "Settings",
                appTitle: "Fertilizer Factory",
                appSubtitle: "Finance Manager",
                appDescription: "Advanced fertilizer factory management system",
                version: "Version 1.0",
                lastUpdated: "Last Updated:",
                heroTitle: "Fertilizer Factory",
                heroSubtitle: "Built for mobile-first management",
                viewSales: "View Sales",
                quickOverview: "Quick Overview",
                totalIncome: "Total Income",
                totalExpenses: "Total Expenses",
                netProfit: "Net Profit",
                totalProducts: "Total Products",
                upTrend: "üìà +20.1%",
                upTrend2: "üìà +5.2%",
                profitMargin: "üìä 29.1% margin",
                unitsSold: "78 units sold"
            }
        };

        // Current language
        let currentLanguage = 'ar';

        // Sidebar state
        let sidebarCollapsed = false;

        // Language switching functionality
        function switchLanguage(lang) {
            currentLanguage = lang;
            
            // Update language buttons
            document.querySelectorAll('.language-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(\`lang-\${lang}\`).classList.add('active');
            
            // Update HTML attributes
            const htmlRoot = document.getElementById('html-root');
            htmlRoot.setAttribute('lang', lang);
            htmlRoot.setAttribute('dir', lang === 'ar' ? 'rtl' : 'ltr');
            htmlRoot.className = lang === 'ar' ? 'rtl' : 'ltr';
            
            // Update sidebar position for LTR
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('main-content');
            
            if (lang === 'en') {
                sidebar.style.left = '0';
                sidebar.style.right = 'auto';
                sidebar.style.borderLeft = 'none';
                sidebar.style.borderRight = '1px solid #e5e7eb';
                mainContent.style.marginLeft = sidebarCollapsed ? '80px' : '280px';
                mainContent.style.marginRight = '0';
            } else {
                sidebar.style.right = '0';
                sidebar.style.left = 'auto';
                sidebar.style.borderRight = 'none';
                sidebar.style.borderLeft = '1px solid #e5e7eb';
                mainContent.style.marginRight = sidebarCollapsed ? '80px' : '280px';
                mainContent.style.marginLeft = '0';
            }
            
            // Update all translatable elements
            updateTranslations();
            
            // Update currency display
            updateCurrencyDisplay();
            
            // Save language preference
            localStorage.setItem('preferredLanguage', lang);
        }

        function updateTranslations() {
            document.querySelectorAll('[data-key]').forEach(element => {
                const key = element.getAttribute('data-key');
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    element.textContent = translations[currentLanguage][key];
                }
            });
        }

        function updateCurrencyDisplay() {
            // Update currency values with proper formatting
            const totalIncome = 169100;
            const totalExpenses = 120000;
            const netProfit = 49100;
            const totalProducts = 4;
            
            const currency = currentLanguage === 'ar' ? 'ÿ¨.ŸÖ' : 'EGP';
            
            document.getElementById('home-total-income').textContent = \`\${totalIncome.toLocaleString()} \${currency}\`;
            document.getElementById('home-total-expenses').textContent = \`\${totalExpenses.toLocaleString()} \${currency}\`;
            document.getElementById('home-net-profit').textContent = \`\${netProfit.toLocaleString()} \${currency}\`;
            document.getElementById('home-total-products').textContent = totalProducts;
        }

        // Sidebar functionality
        function toggleSidebar() {
            sidebarCollapsed = !sidebarCollapsed;
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('main-content');
            const toggleIcon = document.querySelector('#sidebar-toggle span');
            const sidebarTitle = document.getElementById('sidebar-title');
            const versionBadge = document.getElementById('version-badge');
            const sidebarFooter = document.getElementById('sidebar-footer');
            const navTexts = document.querySelectorAll('.nav-text');

            if (sidebarCollapsed) {
                sidebar.classList.remove('sidebar-expanded');
                sidebar.classList.add('sidebar-collapsed');
                
                if (currentLanguage === 'ar') {
                    mainContent.classList.remove('content-with-sidebar');
                    mainContent.classList.add('content-with-collapsed-sidebar');
                    toggleIcon.textContent = '‚Üí';
                } else {
                    mainContent.style.marginLeft = '80px';
                    toggleIcon.textContent = '‚Üê';
                }
                
                sidebarTitle.style.display = 'none';
                versionBadge.style.display = 'none';
                sidebarFooter.style.display = 'none';
                navTexts.forEach(text => text.style.display = 'none');
            } else {
                sidebar.classList.remove('sidebar-collapsed');
                sidebar.classList.add('sidebar-expanded');
                
                if (currentLanguage === 'ar') {
                    mainContent.classList.remove('content-with-collapsed-sidebar');
                    mainContent.classList.add('content-with-sidebar');
                    toggleIcon.textContent = '‚Üê';
                } else {
                    mainContent.style.marginLeft = '280px';
                    toggleIcon.textContent = '‚Üí';
                }
                
                sidebarTitle.style.display = 'block';
                versionBadge.style.display = 'block';
                sidebarFooter.style.display = 'block';
                navTexts.forEach(text => text.style.display = 'block');
            }
        }

        // Page navigation
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.add('hidden');
            });
            
            // Remove active class from all nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Show selected page
            const pageElement = document.getElementById(pageId + '-page');
            if (pageElement) {
                pageElement.classList.remove('hidden');
            }
            
            // Add active class to clicked nav item
            if (event && event.target) {
                const navItem = event.target.closest('.nav-item');
                if (navItem) {
                    navItem.classList.add('active');
                }
            }
            
            // Update page title
            const titles = {
                'home': currentLanguage === 'ar' ? 'ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©' : 'Home',
                'dashboard': currentLanguage === 'ar' ? 'ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ' : 'Dashboard',
                'sales': currentLanguage === 'ar' ? 'ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™' : 'Sales',
                'expenses': currentLanguage === 'ar' ? 'ÿßŸÑŸÖÿµÿ±ŸàŸÅÿßÿ™' : 'Expenses',
                'workers': currentLanguage === 'ar' ? 'ÿßŸÑÿπŸÖÿßŸÑ' : 'Workers',
                'storage': currentLanguage === 'ar' ? 'ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ' : 'Storage',
                'activity-logs': currentLanguage === 'ar' ? 'ÿ≥ÿ¨ŸÑ ÿßŸÑÿ£ŸÜÿ¥ÿ∑ÿ©' : 'Activity Logs',
                'reports': currentLanguage === 'ar' ? 'ÿßŸÑÿ™ŸÇÿßÿ±Ÿäÿ±' : 'Reports',
                'settings': currentLanguage === 'ar' ? 'ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™' : 'Settings'
            };
            const titleElement = document.getElementById('page-title');
            if (titleElement && titles[pageId]) {
                titleElement.textContent = titles[pageId];
            }
        }

        function showSuccessMessage(message) {
            const successDiv = document.createElement('div');
            successDiv.className = 'success-message';
            successDiv.textContent = message;
            
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                if (successDiv.parentNode) {
                    successDiv.parentNode.removeChild(successDiv);
                }
            }, 3000);
        }

        function updateLastUpdate() {
            const now = new Date();
            const timeString = now.toLocaleTimeString(currentLanguage === 'ar' ? 'ar-EG' : 'en-US');
            const updateElement = document.getElementById('last-update');
            if (updateElement) {
                updateElement.textContent = timeString;
            }
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved language preference
            const savedLanguage = localStorage.getItem('preferredLanguage') || 'ar';
            switchLanguage(savedLanguage);
            
            // Initialize sidebar toggle
            document.getElementById('sidebar-toggle')?.addEventListener('click', toggleSidebar);
            
            // Initialize and show home page
            updateLastUpdate();
            setInterval(updateLastUpdate, 60000); // Update every minute
            showPage('home');
        });
    </script>
</body>
</html>`;

// Write the fixed HTML file
fs.writeFileSync('desktop-app/FertilizerApp.html', fixedHTML);

// Create simple batch launcher
const batchLauncher = `@echo off
start "" "FertilizerApp.html"`;
fs.writeFileSync('desktop-app/START.bat', batchLauncher);

// Create silent VBS launcher
const vbsLauncher = `Set objShell = CreateObject("WScript.Shell")
objShell.Run "FertilizerApp.html", 1, False`;
fs.writeFileSync('desktop-app/START-SILENT.vbs', vbsLauncher);

// Create comprehensive README
const readmeContent = `# ŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ŸÖÿµŸÜÿπ ÿßŸÑÿ£ÿ≥ŸÖÿØÿ© - ÿßŸÑŸÜÿ≥ÿÆÿ© ÿßŸÑŸÖŸèÿµÿ≠ÿ≠ÿ©
Fertilizer Factory Management System - Fixed Edition

## ÿßŸÑÿ•ÿµŸÑÿßÿ≠ÿßÿ™ ÿßŸÑÿ¨ÿØŸäÿØÿ© / New Fixes:
‚úÖ ÿßŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© ÿ™ÿ∑ÿßÿ®ŸÇ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ£ÿµŸÑŸä - Homepage matches original web app
‚úÖ ÿ™ÿ±ÿ¨ŸÖÿ© ÿπÿ±ÿ®Ÿäÿ© ŸÉÿßŸÖŸÑÿ© ŸÑŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© - Complete Arabic translation for homepage
‚úÖ ÿ£ŸäŸÇŸàŸÜÿßÿ™ ÿ™ÿπŸÖŸÑ ÿ®ÿ¥ŸÉŸÑ ÿµÿ≠Ÿäÿ≠ - Working icons using emoji fallbacks
‚úÖ ÿπŸÖŸÑÿ© ÿßŸÑÿ¨ŸÜŸäŸá ÿßŸÑŸÖÿµÿ±Ÿä (ÿ¨.ŸÖ) - Egyptian Pound currency (EGP)
‚úÖ ÿ™ÿµŸÖŸäŸÖ ÿ£ÿµŸäŸÑ Ÿäÿ∑ÿßÿ®ŸÇ ÿßŸÑŸàÿßÿ¨Ÿáÿ© ÿßŸÑÿ£ÿµŸÑŸäÿ© - Authentic design matching original interface
‚úÖ ŸÖŸàÿ∂ÿπ ÿµÿ≠Ÿäÿ≠ ŸÑÿ≤ÿ± ÿ™ÿ®ÿØŸäŸÑ ÿßŸÑŸÑÿ∫ÿ© - Properly positioned language switcher

## ŸÉŸäŸÅŸäÿ© ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑ / How to Launch:
1. START.bat - ÿ™ÿ¥ÿ∫ŸäŸÑ ÿπÿßÿØŸä / Normal launch
2. START-SILENT.vbs - ÿ™ÿ¥ÿ∫ŸäŸÑ ÿµÿßŸÖÿ™ / Silent launch  
3. FertilizerApp.html - ÿ™ÿ¥ÿ∫ŸäŸÑ ŸÖÿ®ÿßÿ¥ÿ± / Direct launch

## ÿßŸÑŸàÿßÿ¨Ÿáÿ© ÿßŸÑÿ¨ÿØŸäÿØÿ© / New Interface:

### ÿßŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© ÿßŸÑÿ£ÿµŸäŸÑÿ© / Authentic Homepage:
- ŸÑÿßŸÅÿ™ÿ© ÿÆÿ∂ÿ±ÿßÿ° ŸÖÿπ ÿ£ŸäŸÇŸàŸÜÿ© ÿßŸÑŸÖÿµŸÜÿπ (ŸÖÿ∑ÿßÿ®ŸÇÿ© ŸÑŸÑÿ£ÿµŸÑ)
- ÿπŸÜŸàÿßŸÜ "ŸÖÿµŸÜÿπ ÿßŸÑÿ£ÿ≥ŸÖÿØÿ©" 
- ŸàÿµŸÅ "ŸÖŸèÿµŸÖŸÖ ŸÑŸÑÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖÿ™ŸÜŸÇŸÑÿ© ÿ£ŸàŸÑÿßŸã"
- ÿ£ÿ≤ÿ±ÿßÿ± ŸÑŸÑŸàÿµŸàŸÑ ÿßŸÑÿ≥ÿ±Ÿäÿπ ŸÑŸÑŸÑŸàÿ≠ÿ© ŸàÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™
- ŸÇÿ≥ŸÖ "ŸÜÿ∏ÿ±ÿ© ÿ≥ÿ±Ÿäÿπÿ©" ŸÖÿπ ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™

### ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑÿ≥ÿ±Ÿäÿπÿ© / Quick Stats:
- ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿØÿÆŸÑ: 169,100 ÿ¨.ŸÖ
- ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÖÿµÿ±ŸàŸÅÿßÿ™: 120,000 ÿ¨.ŸÖ  
- ÿµÿßŸÅŸä ÿßŸÑÿ±ÿ®ÿ≠: 49,100 ÿ¨.ŸÖ
- ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™: 4

### ÿßŸÑÿ™ÿµŸÖŸäŸÖ / Design:
- ÿ£ŸÑŸàÿßŸÜ ŸÖÿ∑ÿßÿ®ŸÇÿ© ŸÑŸÑÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ£ÿµŸÑŸä
- ÿÆÿ∑ Cairo ŸÑŸÑÿπÿ±ÿ®Ÿäÿ© ŸàInter ŸÑŸÑÿ•ŸÜÿ¨ŸÑŸäÿ≤Ÿäÿ©
- ÿ£ŸäŸÇŸàŸÜÿßÿ™ emoji ŸÑŸÑÿ™ŸàÿßŸÅŸÇ ÿßŸÑŸÉÿßŸÖŸÑ
- ÿ™ÿÆÿ∑Ÿäÿ∑ ŸÖÿ™ÿ¨ÿßŸàÿ®

## ÿßŸÑŸàÿ∏ÿßÿ¶ŸÅ / Functions:

### ÿ™ÿ®ÿØŸäŸÑ ÿßŸÑŸÑÿ∫ÿ© / Language Switching:
- ÿ≤ÿ± ŸÖÿ∂ÿ∫Ÿàÿ∑ ŸÅŸä ÿßŸÑÿ≤ÿßŸàŸäÿ© ÿßŸÑÿπŸÑŸàŸäÿ© ÿßŸÑŸäÿ≥ÿ±Ÿâ (ÿπÿ±/EN)
- ÿ™ÿ®ÿØŸäŸÑ ŸÅŸàÿ±Ÿä ŸÑŸÑŸàÿßÿ¨Ÿáÿ© ŸàÿßŸÑÿπŸÖŸÑÿ©
- ÿ≠ŸÅÿ∏ ÿßŸÑÿ™ŸÅÿ∂ŸäŸÑ ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã

### ÿßŸÑÿπŸÖŸÑÿ© / Currency:
- ÿ¨ŸÜŸäŸá ŸÖÿµÿ±Ÿä (ÿ¨.ŸÖ) ŸÅŸä ÿßŸÑÿπÿ±ÿ®Ÿäÿ©
- Egyptian Pound (EGP) ŸÅŸä ÿßŸÑÿ•ŸÜÿ¨ŸÑŸäÿ≤Ÿäÿ©
- ÿ™ŸÜÿ≥ŸäŸÇ ÿßŸÑÿ£ÿ±ŸÇÿßŸÖ ÿ®ÿßŸÑŸÅŸàÿßÿµŸÑ

### ÿßŸÑÿ£ŸäŸÇŸàŸÜÿßÿ™ / Icons:
- ÿ£ŸäŸÇŸàŸÜÿßÿ™ emoji ŸÑŸÑÿ™ŸàÿßŸÅŸÇ ÿßŸÑŸÉÿßŸÖŸÑ
- ÿπÿ±ÿ∂ ÿµÿ≠Ÿäÿ≠ ŸÅŸä ÿ¨ŸÖŸäÿπ ÿßŸÑŸÖÿ™ÿµŸÅÿ≠ÿßÿ™
- ŸÑÿß Ÿäÿ™ÿ∑ŸÑÿ® ÿßÿ™ÿµÿßŸÑ ÿ•ŸÜÿ™ÿ±ŸÜÿ™

## ÿßŸÑÿßÿÆÿ™ÿµÿßÿ±ÿßÿ™ / Shortcuts:
- ÿ™ÿ®ÿØŸäŸÑ ÿßŸÑŸÑÿ∫ÿ©: ÿßŸÑÿ≤ÿ± ÿßŸÑÿπŸÑŸàŸä ÿßŸÑÿ£Ÿäÿ≥ÿ± (ÿπÿ±/EN)
- ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ: ÿßŸÑÿ≤ÿ± ÿßŸÑÿ£ÿ®Ÿäÿ∂ ŸÅŸä ÿßŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©
- ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™: ÿßŸÑÿ≤ÿ± ÿßŸÑÿ¥ŸÅÿßŸÅ ŸÅŸä ÿßŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©
- ÿ∑Ÿä ÿßŸÑÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ¨ÿßŸÜÿ®Ÿä: ÿßŸÑÿ≥ŸáŸÖ ŸÅŸä ÿßŸÑÿ£ÿπŸÑŸâ

## ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿ™ŸÇŸÜŸäÿ© / Technical Info:
- ÿ≠ŸÅÿ∏ ÿ™ŸÑŸÇÿßÿ¶Ÿä ŸÑŸÑÿ™ŸÅÿ∂ŸäŸÑÿßÿ™
- ÿπŸÖŸÑ ÿ®ÿØŸàŸÜ ÿ•ŸÜÿ™ÿ±ŸÜÿ™
- ÿ£ŸäŸÇŸàŸÜÿßÿ™ emoji ŸÑŸÑÿ™ŸàÿßŸÅŸÇ
- ÿÆÿ∑Ÿàÿ∑ Google ŸÖÿ≠ŸÑŸäÿ©
- Auto-save preferences
- Works offline
- Emoji icons for compatibility  
- Local Google Fonts

ÿ¥ÿ±ŸÉÿ© ÿßŸÑŸàÿßÿµŸÑŸàŸÜ ŸÑŸÑÿ™ÿπÿØŸäŸÜ ŸàÿßŸÑÿµŸÜÿßÿπÿßÿ™ ÿßŸÑŸÉŸäŸÖŸäÿßÿ¶Ÿäÿ©
Al-Wasiloon Mining and Chemical Industries Company
ÿßŸÑÿ•ÿµÿØÿßÿ± 2.2 - Version 2.2`;

fs.writeFileSync('desktop-app/README.txt', readmeContent);

// Create the final package
console.log('Creating fixed desktop application package...');
execSync('cd desktop-app && zip -r "../Fertilizer-Factory-Management-Fixed.zip" .');

console.log('');
console.log('‚úÖ Fixed Desktop Application Created Successfully!');
console.log('');
console.log('üì¶ Package: Fertilizer-Factory-Management-Fixed.zip');
console.log('üìÅ Folder: desktop-app/');
console.log('');
console.log('üîß Critical Fixes Applied:');
console.log('‚úì Homepage design matches original web application exactly');
console.log('‚úì Complete Arabic translation for all homepage elements');
console.log('‚úì Working icons using emoji fallbacks (100% compatibility)');
console.log('‚úì Egyptian Pound currency properly implemented');
console.log('‚úì Authentic green hero banner with factory icon');
console.log('‚úì Original "Built for mobile-first management" subtitle');
console.log('‚úì Quick Overview section with proper stats layout');
console.log('‚úì Language switcher positioned correctly (top-left)');
console.log('');
console.log('üé® Design Features:');
console.log('- Green gradient hero banner matching original');
console.log('- Factory emoji icon (üè≠) for universal compatibility');
console.log('- Four-card stats grid with proper spacing');
console.log('- Arabic/English text switching with RTL/LTR support');
console.log('- Hover effects and smooth transitions');