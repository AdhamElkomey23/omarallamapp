<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Al-Wasiloon Fertilizer Factory Management</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-50: #f0fdf4;
            --primary-100: #dcfce7;
            --primary-200: #bbf7d0;
            --primary-300: #86efac;
            --primary-400: #4ade80;
            --primary-500: #22c55e;
            --primary-600: #16a34a;
            --primary-700: #15803d;
            --primary-800: #166534;
            --primary-900: #14532d;
            --success-50: #f0fdf4;
            --success-100: #dcfce7;
            --success-200: #bbf7d0;
            --success-300: #86efac;
            --success-400: #4ade80;
            --success-500: #22c55e;
            --success-600: #16a34a;
            --success-700: #15803d;
            --success-800: #166534;
            --success-900: #14532d;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
            --blue-500: #3b82f6;
            --blue-600: #2563eb;
            --red-500: #ef4444;
            --red-600: #dc2626;
            --yellow-500: #eab308;
            --yellow-600: #ca8a04;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--gray-50) 0%, var(--primary-50) 100%);
            color: var(--gray-800);
            min-height: 100vh;
            line-height: 1.6;
        }

        .ltr {
            direction: ltr;
            font-family: 'Inter', 'Cairo', sans-serif;
        }

        .ltr * {
            text-align: left;
        }

        .container {
            display: flex;
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--success-600), var(--success-500));
            color: white;
            padding: 16px 24px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            background: rgba(255, 255, 255, 0.2);
            padding: 12px;
            border-radius: 12px;
            font-size: 24px;
        }

        .logo-text h1 {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 2px;
        }

        .logo-text p {
            font-size: 14px;
            opacity: 0.9;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .current-time {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 500;
            font-size: 14px;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: white;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.05);
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
            z-index: 40;
        }

        .sidebar-header {
            padding: 24px 20px;
            border-bottom: 1px solid var(--gray-200);
            background: linear-gradient(135deg, var(--success-600), var(--success-500));
            color: white;
        }

        .sidebar-nav {
            padding: 16px 0;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            color: var(--gray-700);
            text-decoration: none;
            transition: all 0.2s ease;
            border-right: 3px solid transparent;
            cursor: pointer;
        }

        .ltr .nav-item {
            border-right: none;
            border-left: 3px solid transparent;
        }

        .nav-item:hover, .nav-item.active {
            background: var(--primary-50);
            color: var(--primary-700);
            border-right-color: var(--primary-600);
        }

        .ltr .nav-item:hover, .ltr .nav-item.active {
            border-left-color: var(--primary-600);
        }

        .nav-icon {
            font-size: 20px;
            width: 24px;
            text-align: center;
        }

        .nav-text {
            font-weight: 500;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-right: 280px;
            background: transparent;
        }

        .ltr .main-content {
            margin-left: 280px;
            margin-right: 0;
        }

        .content {
            padding: 24px;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Language Switcher */
        .language-switcher {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 100;
            display: flex;
            background: white;
            border-radius: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .rtl .language-switcher {
            right: 20px;
            left: auto;
        }

        .language-btn {
            padding: 8px 16px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.2s ease;
            color: var(--gray-600);
        }

        .language-btn.active {
            background: var(--success-600);
            color: white;
        }

        /* Cards */
        .card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            margin-bottom: 24px;
            border: 1px solid var(--gray-100);
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 16px;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: white;
            padding: 24px;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            text-align: center;
            position: relative;
            overflow: hidden;
            border: 1px solid var(--gray-100);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--success-500), var(--success-400));
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--success-600);
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 14px;
            color: var(--gray-600);
            font-weight: 500;
        }

        /* Hero Section */
        .hero-section {
            background: linear-gradient(135deg, var(--success-600), var(--success-500));
            color: white;
            padding: 60px 40px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 32px;
            position: relative;
            overflow: hidden;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='30' cy='30' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E") repeat;
            animation: float 20s ease-in-out infinite;
        }

        .hero-title {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 16px;
            position: relative;
            z-index: 1;
        }

        .hero-subtitle {
            font-size: 18px;
            opacity: 0.9;
            margin-bottom: 32px;
            position: relative;
            z-index: 1;
        }

        .hero-buttons {
            display: flex;
            gap: 16px;
            justify-content: center;
            flex-wrap: wrap;
            position: relative;
            z-index: 1;
        }

        .hero-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .hero-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        /* Forms */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .form-field {
            display: flex;
            flex-direction: column;
        }

        .form-field label {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--gray-700);
        }

        .form-field input,
        .form-field select,
        .form-field textarea {
            padding: 12px 16px;
            border: 2px solid var(--gray-200);
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.2s ease;
            background: white;
        }

        .form-field input:focus,
        .form-field select:focus,
        .form-field textarea:focus {
            outline: none;
            border-color: var(--success-500);
            box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1);
        }

        .form-field textarea {
            resize: vertical;
            min-height: 100px;
        }

        /* Buttons */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            justify-content: center;
        }

        .btn-primary {
            background: var(--success-600);
            color: white;
        }

        .btn-primary:hover {
            background: var(--success-700);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--gray-100);
            color: var(--gray-700);
        }

        .btn-secondary:hover {
            background: var(--gray-200);
        }

        .btn-danger {
            background: var(--red-500);
            color: white;
        }

        .btn-danger:hover {
            background: var(--red-600);
        }

        .btn-warning {
            background: var(--yellow-500);
            color: white;
        }

        .btn-warning:hover {
            background: var(--yellow-600);
        }

        /* Tables */
        .table-container {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            border: 1px solid var(--gray-100);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th {
            background: var(--gray-50);
            padding: 16px;
            text-align: right;
            font-weight: 600;
            color: var(--gray-700);
            border-bottom: 1px solid var(--gray-200);
        }

        .ltr .data-table th {
            text-align: left;
        }

        .data-table td {
            padding: 16px;
            border-bottom: 1px solid var(--gray-100);
        }

        .data-table tr:hover {
            background: var(--gray-50);
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 8px;
        }

        /* Modals */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(4px);
        }

        .modal.hidden {
            display: none;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            padding: 0;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            padding: 24px 24px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--gray-900);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--gray-400);
            padding: 4px;
            border-radius: 4px;
            transition: color 0.2s ease;
        }

        .modal-close:hover {
            color: var(--gray-600);
        }

        .modal-body {
            padding: 24px;
        }

        /* Charts */
        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            margin-bottom: 24px;
            border: 1px solid var(--gray-100);
        }

        .chart-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 16px;
        }

        /* Success Message */
        .success-message {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--success-600);
            color: white;
            padding: 16px 24px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(34, 197, 94, 0.3);
            font-weight: 500;
            z-index: 1001;
            transform: translateX(400px);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .rtl .success-message {
            left: 20px;
            right: auto;
            transform: translateX(-400px);
        }

        .success-message.show {
            transform: translateX(0);
            opacity: 1;
        }

        /* Page visibility */
        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* Empty states */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--gray-500);
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-state-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--gray-700);
        }

        .empty-state-description {
            font-size: 14px;
            color: var(--gray-500);
            margin-bottom: 24px;
        }

        /* Loading states */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Hide elements */
        .hidden {
            display: none !important;
        }

        /* Specific page styles */
        .page-title {
            font-size: 28px;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 16px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                width: 240px;
            }
            
            .main-content {
                margin-right: 240px;
            }
            
            .ltr .main-content {
                margin-left: 240px;
                margin-right: 0;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .hero-title {
                font-size: 32px;
            }
        }
    </style>
</head>
<body>
    <!-- Language Switcher -->
    <div class="language-switcher">
        <button class="language-btn active" onclick="switchLanguage('ar')" id="lang-ar">Ø¹Ø±</button>
        <button class="language-btn" onclick="switchLanguage('en')" id="lang-en">EN</button>
    </div>

    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">ğŸ­</div>
                    <div class="logo-text">
                        <h1 data-key="companyName">Ù…ØµÙ†Ø¹ Ø§Ù„ÙˆØ§ØµÙ„ÙˆÙ†</h1>
                        <p data-key="factorySubtitle">Ù„Ù„ØªØ¹Ø¯ÙŠÙ† ÙˆØ§Ù„ØµÙ†Ø§Ø¹Ø§Øª Ø§Ù„ÙƒÙŠÙ…Ø§ÙˆÙŠØ©</p>
                    </div>
                </div>
            </div>
            <nav class="sidebar-nav">
                <a class="nav-item active" onclick="showPage('home')" data-page="home">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text" data-key="home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
                </a>
                <a class="nav-item" onclick="showPage('sales')" data-page="sales">
                    <span class="nav-icon">ğŸ›’</span>
                    <span class="nav-text" data-key="sales">Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</span>
                </a>
                <a class="nav-item" onclick="showPage('storage')" data-page="storage">
                    <span class="nav-icon">ğŸ“¦</span>
                    <span class="nav-text" data-key="storage">Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</span>
                </a>
                <a class="nav-item" onclick="showPage('expenses')" data-page="expenses">
                    <span class="nav-icon">ğŸ’°</span>
                    <span class="nav-text" data-key="expenses">Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</span>
                </a>
                <a class="nav-item" onclick="showPage('workers')" data-page="workers">
                    <span class="nav-icon">ğŸ‘¥</span>
                    <span class="nav-text" data-key="workers">Ø§Ù„Ø¹Ù…Ø§Ù„</span>
                </a>
                <a class="nav-item" onclick="showPage('activities')" data-page="activities">
                    <span class="nav-icon">ğŸ“‹</span>
                    <span class="nav-text" data-key="activities">Ø³Ø¬Ù„ Ø§Ù„Ø£Ù†Ø´Ø·Ø©</span>
                </a>
                <a class="nav-item" onclick="showPage('reports')" data-page="reports">
                    <span class="nav-icon">ğŸ“ˆ</span>
                    <span class="nav-text" data-key="reports">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</span>
                </a>
            </nav>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <main class="content">
                <!-- Home Page -->
                <div id="home" class="page active">
                    <div class="hero-section">
                        <h1 class="hero-title" data-key="welcomeTitle">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ù…ØµÙ†Ø¹ Ø§Ù„ÙˆØ§ØµÙ„ÙˆÙ†</h1>
                        <p class="hero-subtitle" data-key="welcomeSubtitle">Ù†Ø¸Ø§Ù… Ø´Ø§Ù…Ù„ Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙˆØ§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ©</p>
                        <div class="hero-buttons">
                            <button class="hero-btn" onclick="showPage('sales')">
                                <span>ğŸ›’</span>
                                <span data-key="quickSale">Ø¨ÙŠØ¹ Ø³Ø±ÙŠØ¹</span>
                            </button>
                            <button class="hero-btn" onclick="showPage('storage')">
                                <span>ğŸ“¦</span>
                                <span data-key="checkStorage">ÙØ­Øµ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</span>
                            </button>
                            <button class="hero-btn" onclick="showPage('reports')">
                                <span>ğŸ“ˆ</span>
                                <span data-key="viewReports">Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</span>
                            </button>
                        </div>
                    </div>

                    <!-- Stats Grid -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="total-income">0</div>
                            <div class="stat-label" data-key="totalIncome">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="total-expenses">0</div>
                            <div class="stat-label" data-key="totalExpenses">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="net-profit">0</div>
                            <div class="stat-label" data-key="netProfit">ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="total-workers">0</div>
                            <div class="stat-label" data-key="totalWorkers">Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ø§Ù„</div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="card">
                        <h3 class="card-title" data-key="recentActivities">Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø­Ø¯ÙŠØ«Ø©</h3>
                        <div id="recent-activities">
                            <div class="empty-state">
                                <div class="empty-state-icon">ğŸ“</div>
                                <div class="empty-state-title" data-key="noActivities">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù†Ø´Ø·Ø© Ø­Ø¯ÙŠØ«Ø©</div>
                                <div class="empty-state-description" data-key="activitiesDescription">Ø³ØªØ¸Ù‡Ø± Ø¢Ø®Ø± Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª ÙˆØ§Ù„Ø£Ù†Ø´Ø·Ø© Ù‡Ù†Ø§</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sales Page -->
                <div id="sales" class="page">
                    <h2 class="page-title" data-key="salesManagement">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</h2>
                    
                    <!-- Add Sale Form -->
                    <div class="card">
                        <h3 class="card-title" data-key="addNewSale">Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ¹ Ø¬Ø¯ÙŠØ¯</h3>
                        <form id="sales-form" class="form-grid">
                            <div class="form-field">
                                <label data-key="productName">Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬</label>
                                <input type="text" id="sale-product" required>
                            </div>
                            <div class="form-field">
                                <label data-key="quantity">Ø§Ù„ÙƒÙ…ÙŠØ©</label>
                                <input type="number" id="sale-quantity" required>
                            </div>
                            <div class="form-field">
                                <label data-key="totalAmount">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</label>
                                <input type="number" id="sale-amount" step="0.01" required>
                            </div>
                            <div class="form-field">
                                <label data-key="saleDate">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨ÙŠØ¹</label>
                                <input type="date" id="sale-date" required>
                            </div>
                            <div class="form-field">
                                <label data-key="clientName">Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
                                <input type="text" id="sale-client" required>
                            </div>
                            <div class="form-field">
                                <label data-key="clientContact">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„</label>
                                <input type="text" id="sale-contact">
                            </div>
                            <div class="form-field">
                                <button type="submit" class="btn btn-primary">
                                    <span data-key="addSale">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨ÙŠØ¹</span>
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Sales Table -->
                    <div class="card">
                        <h3 class="card-title" data-key="salesList">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</h3>
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th data-key="productName">Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬</th>
                                        <th data-key="quantity">Ø§Ù„ÙƒÙ…ÙŠØ©</th>
                                        <th data-key="totalAmount">Ø§Ù„Ù…Ø¨Ù„Øº</th>
                                        <th data-key="saleDate">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                        <th data-key="clientName">Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
                                        <th data-key="actions">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                                    </tr>
                                </thead>
                                <tbody id="sales-table">
                                    <!-- Sales data will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Storage Page -->
                <div id="storage" class="page">
                    <h2 class="page-title" data-key="storageManagement">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</h2>
                    
                    <!-- Add Storage Item Form -->
                    <div class="card">
                        <h3 class="card-title" data-key="addStorageItem">Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ù„Ù„Ù…Ø®Ø²ÙˆÙ†</h3>
                        <form id="storage-form" class="form-grid">
                            <div class="form-field">
                                <label data-key="itemName">Ø§Ø³Ù… Ø§Ù„Ø¹Ù†ØµØ±</label>
                                <input type="text" id="storage-item" required>
                            </div>
                            <div class="form-field">
                                <label data-key="itemType">Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù†ØµØ±</label>
                                <select id="storage-type" required>
                                    <option value="raw_material" data-key="rawMaterial">Ù…Ø§Ø¯Ø© Ø®Ø§Ù…</option>
                                    <option value="finished_product" data-key="finishedProduct">Ù…Ù†ØªØ¬ Ù†Ù‡Ø§Ø¦ÙŠ</option>
                                    <option value="packaging" data-key="packaging">ØªØ¹Ø¨Ø¦Ø© ÙˆØªØºÙ„ÙŠÙ</option>
                                    <option value="equipment" data-key="equipment">Ù…Ø¹Ø¯Ø§Øª</option>
                                </select>
                            </div>
                            <div class="form-field">
                                <label data-key="quantity">Ø§Ù„ÙƒÙ…ÙŠØ©</label>
                                <input type="number" id="storage-quantity" required>
                            </div>
                            <div class="form-field">
                                <label data-key="unit">Ø§Ù„ÙˆØ­Ø¯Ø©</label>
                                <select id="storage-unit" required>
                                    <option value="kg" data-key="kg">ÙƒÙŠÙ„ÙˆØ¬Ø±Ø§Ù…</option>
                                    <option value="ton" data-key="ton">Ø·Ù†</option>
                                    <option value="piece" data-key="piece">Ù‚Ø·Ø¹Ø©</option>
                                    <option value="liter" data-key="liter">Ù„ØªØ±</option>
                                    <option value="bag" data-key="bag">ÙƒÙŠØ³</option>
                                </select>
                            </div>
                            <div class="form-field">
                                <label data-key="minLevel">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰</label>
                                <input type="number" id="storage-min" required>
                            </div>
                            <div class="form-field">
                                <button type="submit" class="btn btn-primary">
                                    <span data-key="addItem">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù†ØµØ±</span>
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Storage Table -->
                    <div class="card">
                        <h3 class="card-title" data-key="storageList">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</h3>
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th data-key="itemName">Ø§Ø³Ù… Ø§Ù„Ø¹Ù†ØµØ±</th>
                                        <th data-key="itemType">Ø§Ù„Ù†ÙˆØ¹</th>
                                        <th data-key="quantity">Ø§Ù„ÙƒÙ…ÙŠØ©</th>
                                        <th data-key="unit">Ø§Ù„ÙˆØ­Ø¯Ø©</th>
                                        <th data-key="minLevel">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰</th>
                                        <th data-key="status">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                        <th data-key="actions">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                                    </tr>
                                </thead>
                                <tbody id="storage-table">
                                    <!-- Storage data will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Expenses Page -->
                <div id="expenses" class="page">
                    <h2 class="page-title" data-key="expensesManagement">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</h2>
                    
                    <!-- Add Expense Form -->
                    <div class="card">
                        <h3 class="card-title" data-key="addNewExpense">Ø¥Ø¶Ø§ÙØ© Ù…ØµØ±ÙˆÙ Ø¬Ø¯ÙŠØ¯</h3>
                        <form id="expenses-form" class="form-grid">
                            <div class="form-field">
                                <label data-key="expenseName">Ø§Ø³Ù… Ø§Ù„Ù…ØµØ±ÙˆÙ</label>
                                <input type="text" id="expense-name" required>
                            </div>
                            <div class="form-field">
                                <label data-key="amount">Ø§Ù„Ù…Ø¨Ù„Øº</label>
                                <input type="number" id="expense-amount" step="0.01" required>
                            </div>
                            <div class="form-field">
                                <label data-key="category">Ø§Ù„ÙØ¦Ø©</label>
                                <select id="expense-category" required>
                                    <option value="operations" data-key="operations">Ø¹Ù…Ù„ÙŠØ§Øª</option>
                                    <option value="utilities" data-key="utilities">Ù…Ø±Ø§ÙÙ‚</option>
                                    <option value="maintenance" data-key="maintenance">ØµÙŠØ§Ù†Ø©</option>
                                    <option value="salaries" data-key="salaries">Ø±ÙˆØ§ØªØ¨</option>
                                    <option value="materials" data-key="materials">Ù…ÙˆØ§Ø¯</option>
                                    <option value="transport" data-key="transport">Ù†Ù‚Ù„</option>
                                    <option value="administrative" data-key="administrative">Ø¥Ø¯Ø§Ø±ÙŠØ©</option>
                                    <option value="other" data-key="other">Ø£Ø®Ø±Ù‰</option>
                                </select>
                            </div>
                            <div class="form-field">
                                <label data-key="expenseDate">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ØµØ±ÙˆÙ</label>
                                <input type="date" id="expense-date" required>
                            </div>
                            <div class="form-field">
                                <button type="submit" class="btn btn-primary">
                                    <span data-key="addExpense">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ØµØ±ÙˆÙ</span>
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Expenses Table -->
                    <div class="card">
                        <h3 class="card-title" data-key="expensesList">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</h3>
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th data-key="expenseName">Ø§Ø³Ù… Ø§Ù„Ù…ØµØ±ÙˆÙ</th>
                                        <th data-key="amount">Ø§Ù„Ù…Ø¨Ù„Øº</th>
                                        <th data-key="category">Ø§Ù„ÙØ¦Ø©</th>
                                        <th data-key="expenseDate">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                        <th data-key="actions">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                                    </tr>
                                </thead>
                                <tbody id="expenses-table">
                                    <!-- Expenses data will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Workers Page -->
                <div id="workers" class="page">
                    <h2 class="page-title" data-key="workersManagement">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ø§Ù„</h2>
                    
                    <!-- Add Worker Form -->
                    <div class="card">
                        <h3 class="card-title" data-key="addNewWorker">Ø¥Ø¶Ø§ÙØ© Ø¹Ø§Ù…Ù„ Ø¬Ø¯ÙŠØ¯</h3>
                        <form id="workers-form" class="form-grid">
                            <div class="form-field">
                                <label data-key="workerName">Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ù…Ù„</label>
                                <input type="text" id="worker-name" required>
                            </div>
                            <div class="form-field">
                                <label data-key="position">Ø§Ù„Ù…Ù†ØµØ¨</label>
                                <select id="worker-position" required>
                                    <option value="operator" data-key="operator">Ù…Ø´ØºÙ„</option>
                                    <option value="technician" data-key="technician">ÙÙ†ÙŠ</option>
                                    <option value="supervisor" data-key="supervisor">Ù…Ø´Ø±Ù</option>
                                    <option value="manager" data-key="manager">Ù…Ø¯ÙŠØ±</option>
                                    <option value="maintenance" data-key="maintenanceWorker">Ø¹Ø§Ù…Ù„ ØµÙŠØ§Ù†Ø©</option>
                                    <option value="security" data-key="security">Ø£Ù…Ù†</option>
                                    <option value="driver" data-key="driver">Ø³Ø§Ø¦Ù‚</option>
                                    <option value="cleaner" data-key="cleaner">Ø¹Ø§Ù…Ù„ Ù†Ø¸Ø§ÙØ©</option>
                                </select>
                            </div>
                            <div class="form-field">
                                <label data-key="department">Ø§Ù„Ù‚Ø³Ù…</label>
                                <select id="worker-department" required>
                                    <option value="production" data-key="production">Ø§Ù„Ø¥Ù†ØªØ§Ø¬</option>
                                    <option value="quality" data-key="quality">Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø¬ÙˆØ¯Ø©</option>
                                    <option value="maintenance" data-key="maintenanceDept">Ø§Ù„ØµÙŠØ§Ù†Ø©</option>
                                    <option value="warehouse" data-key="warehouse">Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹</option>
                                    <option value="administration" data-key="administrationDept">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</option>
                                    <option value="sales" data-key="salesDept">Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</option>
                                    <option value="security" data-key="securityDept">Ø§Ù„Ø£Ù…Ù†</option>
                                </select>
                            </div>
                            <div class="form-field">
                                <label data-key="salary">Ø§Ù„Ø±Ø§ØªØ¨</label>
                                <input type="number" id="worker-salary" step="0.01" required>
                            </div>
                            <div class="form-field">
                                <label data-key="phone">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                                <input type="text" id="worker-phone">
                            </div>
                            <div class="form-field">
                                <label data-key="hireDate">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙˆØ¸ÙŠÙ</label>
                                <input type="date" id="worker-hire-date" required>
                            </div>
                            <div class="form-field">
                                <button type="submit" class="btn btn-primary">
                                    <span data-key="addWorker">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ø§Ù…Ù„</span>
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Workers Table -->
                    <div class="card">
                        <h3 class="card-title" data-key="workersList">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ù…Ø§Ù„</h3>
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th data-key="workerName">Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ù…Ù„</th>
                                        <th data-key="position">Ø§Ù„Ù…Ù†ØµØ¨</th>
                                        <th data-key="department">Ø§Ù„Ù‚Ø³Ù…</th>
                                        <th data-key="salary">Ø§Ù„Ø±Ø§ØªØ¨</th>
                                        <th data-key="phone">Ø§Ù„Ù‡Ø§ØªÙ</th>
                                        <th data-key="hireDate">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙˆØ¸ÙŠÙ</th>
                                        <th data-key="actions">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                                    </tr>
                                </thead>
                                <tbody id="workers-table">
                                    <!-- Workers data will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Activities Page -->
                <div id="activities" class="page">
                    <h2 class="page-title" data-key="activitiesManagement">Ø¥Ø¯Ø§Ø±Ø© Ø³Ø¬Ù„ Ø§Ù„Ø£Ù†Ø´Ø·Ø©</h2>
                    
                    <!-- Add Activity Form -->
                    <div class="card">
                        <h3 class="card-title" data-key="addNewActivity">Ø¥Ø¶Ø§ÙØ© Ù†Ø´Ø§Ø· Ø¬Ø¯ÙŠØ¯</h3>
                        <form id="activities-form" class="form-grid">
                            <div class="form-field">
                                <label data-key="activityTitle">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù†Ø´Ø§Ø·</label>
                                <input type="text" id="activity-title" required>
                            </div>
                            <div class="form-field">
                                <label data-key="activityDescription">ÙˆØµÙ Ø§Ù„Ù†Ø´Ø§Ø·</label>
                                <textarea id="activity-description" required></textarea>
                            </div>
                            <div class="form-field">
                                <label data-key="activityDate">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ø´Ø§Ø·</label>
                                <input type="date" id="activity-date" required>
                            </div>
                            <div class="form-field">
                                <button type="submit" class="btn btn-primary">
                                    <span data-key="addActivity">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ø´Ø§Ø·</span>
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Activities Table -->
                    <div class="card">
                        <h3 class="card-title" data-key="activitiesList">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ù†Ø´Ø·Ø©</h3>
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th data-key="activityTitle">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù†Ø´Ø§Ø·</th>
                                        <th data-key="activityDescription">Ø§Ù„ÙˆØµÙ</th>
                                        <th data-key="activityDate">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                        <th data-key="actions">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                                    </tr>
                                </thead>
                                <tbody id="activities-table">
                                    <!-- Activities data will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Reports Page -->
                <div id="reports" class="page">
                    <h2 class="page-title" data-key="reportsAnalytics">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª</h2>
                    
                    <!-- Financial Summary -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="report-income">0</div>
                            <div class="stat-label" data-key="monthlyIncome">Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="report-expenses">0</div>
                            <div class="stat-label" data-key="monthlyExpenses">Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="report-profit">0</div>
                            <div class="stat-label" data-key="monthlyProfit">Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø´Ù‡Ø±ÙŠ</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="report-storage-items">0</div>
                            <div class="stat-label" data-key="storageItems">Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</div>
                        </div>
                    </div>

                    <!-- Charts -->
                    <div class="chart-container">
                        <h3 class="chart-title" data-key="financialChart">Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ø§Ù„Ù…Ø§Ù„ÙŠ</h3>
                        <canvas id="financial-chart"></canvas>
                    </div>

                    <!-- Export Options -->
                    <div class="card">
                        <h3 class="card-title" data-key="exportData">ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
                        <div class="form-grid">
                            <button class="btn btn-secondary" onclick="exportData('sales')">
                                <span>ğŸ“Š</span>
                                <span data-key="exportSales">ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</span>
                            </button>
                            <button class="btn btn-secondary" onclick="exportData('expenses')">
                                <span>ğŸ’°</span>
                                <span data-key="exportExpenses">ØªØµØ¯ÙŠØ± Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</span>
                            </button>
                            <button class="btn btn-secondary" onclick="exportData('storage')">
                                <span>ğŸ“¦</span>
                                <span data-key="exportStorage">ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</span>
                            </button>
                            <button class="btn btn-secondary" onclick="exportData('workers')">
                                <span>ğŸ‘¥</span>
                                <span data-key="exportWorkers">ØªØµØ¯ÙŠØ± Ø§Ù„Ø¹Ù…Ø§Ù„</span>
                            </button>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Edit Sale Modal -->
    <div id="edit-sale-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" data-key="editSale">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ¹</h3>
                <button class="modal-close" onclick="closeModal('edit-sale-modal')">Ã—</button>
            </div>
            <div class="modal-body">
                <form id="edit-sale-form" class="form-grid">
                    <div class="form-field">
                        <label data-key="productName">Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬</label>
                        <input type="text" id="edit-sale-product" required>
                    </div>
                    <div class="form-field">
                        <label data-key="quantity">Ø§Ù„ÙƒÙ…ÙŠØ©</label>
                        <input type="number" id="edit-sale-quantity" required>
                    </div>
                    <div class="form-field">
                        <label data-key="totalAmount">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</label>
                        <input type="number" id="edit-sale-amount" step="0.01" required>
                    </div>
                    <div class="form-field">
                        <label data-key="saleDate">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨ÙŠØ¹</label>
                        <input type="date" id="edit-sale-date" required>
                    </div>
                    <div class="form-field">
                        <label data-key="clientName">Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
                        <input type="text" id="edit-sale-client" required>
                    </div>
                    <div class="form-field">
                        <label data-key="clientContact">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„</label>
                        <input type="text" id="edit-sale-contact">
                    </div>
                    <div class="form-field">
                        <button type="submit" class="btn btn-primary">
                            <span data-key="updateSale">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ¹</span>
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="closeModal('edit-sale-modal')">
                            <span data-key="cancel">Ø¥Ù„ØºØ§Ø¡</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Success Message -->
    <div id="success-message" class="success-message">
        <span id="success-text">ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­!</span>
    </div>

    <script>
        // Embed the complete app.js content here
        // Data Storage
        const data = {
            sales: [
                {
                    id: 1,
                    productName: "Ammonium Nitrate",
                    quantity: 100,
                    totalAmount: 15000,
                    saleDate: new Date('2024-01-15'),
                    clientName: "Ahmed Mohamed Farm",
                    clientContact: "01234567890",
                    createdAt: new Date('2024-01-15')
                },
                {
                    id: 2,
                    productName: "Phosphate Fertilizer",
                    quantity: 75,
                    totalAmount: 18500,
                    saleDate: new Date('2024-01-20'),
                    clientName: "Green Valley Agriculture",
                    clientContact: "01987654321",
                    createdAt: new Date('2024-01-20')
                },
                {
                    id: 3,
                    productName: "Potassium Chloride",
                    quantity: 50,
                    totalAmount: 12000,
                    saleDate: new Date('2024-02-01'),
                    clientName: "Desert Oasis Farms",
                    clientContact: "01555444333",
                    createdAt: new Date('2024-02-01')
                }
            ],
            expenses: [
                {
                    id: 1,
                    name: "Electricity Bill",
                    amount: 15000,
                    category: "utilities",
                    expenseDate: new Date('2024-01-10'),
                    createdAt: new Date('2024-01-10')
                },
                {
                    id: 2,
                    name: "Raw Materials Purchase",
                    amount: 50000,
                    category: "materials",
                    expenseDate: new Date('2024-01-15'),
                    createdAt: new Date('2024-01-15')
                },
                {
                    id: 3,
                    name: "Equipment Maintenance",
                    amount: 8000,
                    category: "maintenance",
                    expenseDate: new Date('2024-01-25'),
                    createdAt: new Date('2024-01-25')
                },
                {
                    id: 4,
                    name: "Transportation Costs",
                    amount: 12000,
                    category: "transport",
                    expenseDate: new Date('2024-02-05'),
                    createdAt: new Date('2024-02-05')
                },
                {
                    id: 5,
                    name: "Worker Salaries",
                    amount: 35000,
                    category: "salaries",
                    expenseDate: new Date('2024-02-01'),
                    createdAt: new Date('2024-02-01')
                }
            ],
            workers: [
                {
                    id: 1,
                    name: "Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯",
                    position: "supervisor",
                    department: "production",
                    salary: 8000,
                    phone: "01234567890",
                    hireDate: new Date('2023-06-01'),
                    createdAt: new Date('2023-06-01')
                },
                {
                    id: 2,
                    name: "ÙØ§Ø·Ù…Ø© Ø¹Ù„ÙŠ",
                    position: "technician",
                    department: "quality",
                    salary: 6500,
                    phone: "01987654321",
                    hireDate: new Date('2023-08-15'),
                    createdAt: new Date('2023-08-15')
                },
                {
                    id: 3,
                    name: "Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ù…Ø­Ù…ÙˆØ¯",
                    position: "operator",
                    department: "production",
                    salary: 5500,
                    phone: "01555444333",
                    hireDate: new Date('2023-09-01'),
                    createdAt: new Date('2023-09-01')
                },
                {
                    id: 4,
                    name: "Ø³Ø§Ø±Ø© Ø­Ø³Ù†",
                    position: "manager",
                    department: "administration",
                    salary: 12000,
                    phone: "01777888999",
                    hireDate: new Date('2023-03-01'),
                    createdAt: new Date('2023-03-01')
                }
            ],
            storageItems: [
                {
                    id: 1,
                    itemName: "Ammonium Nitrate",
                    itemType: "raw_material",
                    quantity: 500,
                    unit: "ton",
                    minLevel: 50,
                    createdAt: new Date('2024-01-01')
                },
                {
                    id: 2,
                    itemName: "Phosphate Rock",
                    itemType: "raw_material",
                    quantity: 300,
                    unit: "ton",
                    minLevel: 100,
                    createdAt: new Date('2024-01-01')
                },
                {
                    id: 3,
                    itemName: "Potassium Chloride",
                    itemType: "finished_product",
                    quantity: 25,
                    unit: "ton",
                    minLevel: 30,
                    createdAt: new Date('2024-01-01')
                },
                {
                    id: 4,
                    itemName: "Packaging Bags",
                    itemType: "packaging",
                    quantity: 1000,
                    unit: "piece",
                    minLevel: 200,
                    createdAt: new Date('2024-01-01')
                }
            ],
            activityLogs: [
                {
                    id: 1,
                    title: "ØªÙ… ØªØ­Ø¯ÙŠØ« Ø®Ø· Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ø£ÙˆÙ„",
                    description: "ØªÙ… Ø¥Ø¬Ø±Ø§Ø¡ ØµÙŠØ§Ù†Ø© Ø´Ø§Ù…Ù„Ø© Ù„Ø®Ø· Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ø£ÙˆÙ„ ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ø¯Ø§Øª",
                    logDate: new Date('2024-01-20'),
                    createdAt: new Date('2024-01-20')
                },
                {
                    id: 2,
                    title: "Ø§Ø³ØªÙ„Ø§Ù… Ø´Ø­Ù†Ø© Ù…ÙˆØ§Ø¯ Ø®Ø§Ù… Ø¬Ø¯ÙŠØ¯Ø©",
                    description: "ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… 100 Ø·Ù† Ù…Ù† ÙÙˆØ³ÙØ§Øª Ø§Ù„ØµØ®ÙˆØ± Ù…Ù† Ø§Ù„Ù…ÙˆØ±Ø¯ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",
                    logDate: new Date('2024-01-25'),
                    createdAt: new Date('2024-01-25')
                },
                {
                    id: 3,
                    title: "Ø§Ø¬ØªÙ…Ø§Ø¹ ÙØ±ÙŠÙ‚ Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø¬ÙˆØ¯Ø©",
                    description: "Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø¬ÙˆØ¯Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ÙˆØªØ­Ø¯ÙŠØ« Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ÙØ­Øµ",
                    logDate: new Date('2024-02-01'),
                    createdAt: new Date('2024-02-01')
                }
            ]
        };

        // Global variables
        let currentLanguage = 'ar';
        let editingId = null;
        let charts = {};

        // Translation system
        const translations = {
            ar: {
                // Company info
                companyName: "Ù…ØµÙ†Ø¹ Ø§Ù„ÙˆØ§ØµÙ„ÙˆÙ†",
                factorySubtitle: "Ù„Ù„ØªØ¹Ø¯ÙŠÙ† ÙˆØ§Ù„ØµÙ†Ø§Ø¹Ø§Øª Ø§Ù„ÙƒÙŠÙ…Ø§ÙˆÙŠØ©",
                managementSystem: "Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©",
                
                // Navigation
                home: "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
                sales: "Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª",
                storage: "Ø§Ù„Ù…Ø®Ø²ÙˆÙ†",
                expenses: "Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª",
                workers: "Ø§Ù„Ø¹Ù…Ø§Ù„",
                activities: "Ø³Ø¬Ù„ Ø§Ù„Ø£Ù†Ø´Ø·Ø©",
                reports: "Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±",
                
                // Home page
                welcomeTitle: "Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ù…ØµÙ†Ø¹ Ø§Ù„ÙˆØ§ØµÙ„ÙˆÙ†",
                welcomeSubtitle: "Ù†Ø¸Ø§Ù… Ø´Ø§Ù…Ù„ Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙˆØ§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ©",
                quickSale: "Ø¨ÙŠØ¹ Ø³Ø±ÙŠØ¹",
                checkStorage: "ÙØ­Øµ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†",
                viewReports: "Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±",
                totalIncome: "Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª",
                totalExpenses: "Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª",
                netProfit: "ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­",
                totalWorkers: "Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ø§Ù„",
                recentActivities: "Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø­Ø¯ÙŠØ«Ø©",
                noActivities: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù†Ø´Ø·Ø© Ø­Ø¯ÙŠØ«Ø©",
                activitiesDescription: "Ø³ØªØ¸Ù‡Ø± Ø¢Ø®Ø± Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª ÙˆØ§Ù„Ø£Ù†Ø´Ø·Ø© Ù‡Ù†Ø§",
                
                // Sales
                salesManagement: "Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª",
                addNewSale: "Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ¹ Ø¬Ø¯ÙŠØ¯",
                salesList: "Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª",
                productName: "Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬",
                quantity: "Ø§Ù„ÙƒÙ…ÙŠØ©",
                totalAmount: "Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ",
                saleDate: "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨ÙŠØ¹",
                clientName: "Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„",
                clientContact: "Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„",
                addSale: "Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨ÙŠØ¹",
                editSale: "ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ¹",
                updateSale: "ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ¹",
                
                // Storage
                storageManagement: "Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ†",
                addStorageItem: "Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ù„Ù„Ù…Ø®Ø²ÙˆÙ†",
                storageList: "Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ†",
                itemName: "Ø§Ø³Ù… Ø§Ù„Ø¹Ù†ØµØ±",
                itemType: "Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù†ØµØ±",
                unit: "Ø§Ù„ÙˆØ­Ø¯Ø©",
                minLevel: "Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰",
                status: "Ø§Ù„Ø­Ø§Ù„Ø©",
                addItem: "Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù†ØµØ±",
                rawMaterial: "Ù…Ø§Ø¯Ø© Ø®Ø§Ù…",
                finishedProduct: "Ù…Ù†ØªØ¬ Ù†Ù‡Ø§Ø¦ÙŠ",
                packaging: "ØªØ¹Ø¨Ø¦Ø© ÙˆØªØºÙ„ÙŠÙ",
                equipment: "Ù…Ø¹Ø¯Ø§Øª",
                kg: "ÙƒÙŠÙ„ÙˆØ¬Ø±Ø§Ù…",
                ton: "Ø·Ù†",
                piece: "Ù‚Ø·Ø¹Ø©",
                liter: "Ù„ØªØ±",
                bag: "ÙƒÙŠØ³",
                inStock: "Ù…ØªÙˆÙØ±",
                lowStock: "Ù…Ø®Ø²ÙˆÙ† Ù…Ù†Ø®ÙØ¶",
                outOfStock: "Ù†ÙØ¯ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†",
                
                // Expenses
                expensesManagement: "Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª",
                addNewExpense: "Ø¥Ø¶Ø§ÙØ© Ù…ØµØ±ÙˆÙ Ø¬Ø¯ÙŠØ¯",
                expensesList: "Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª",
                expenseName: "Ø§Ø³Ù… Ø§Ù„Ù…ØµØ±ÙˆÙ",
                amount: "Ø§Ù„Ù…Ø¨Ù„Øº",
                category: "Ø§Ù„ÙØ¦Ø©",
                expenseDate: "ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ØµØ±ÙˆÙ",
                addExpense: "Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ØµØ±ÙˆÙ",
                operations: "Ø¹Ù…Ù„ÙŠØ§Øª",
                utilities: "Ù…Ø±Ø§ÙÙ‚",
                maintenance: "ØµÙŠØ§Ù†Ø©",
                salaries: "Ø±ÙˆØ§ØªØ¨",
                materials: "Ù…ÙˆØ§Ø¯",
                transport: "Ù†Ù‚Ù„",
                administrative: "Ø¥Ø¯Ø§Ø±ÙŠØ©",
                other: "Ø£Ø®Ø±Ù‰",
                
                // Workers
                workersManagement: "Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ø§Ù„",
                addNewWorker: "Ø¥Ø¶Ø§ÙØ© Ø¹Ø§Ù…Ù„ Ø¬Ø¯ÙŠØ¯",
                workersList: "Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ù…Ø§Ù„",
                workerName: "Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ù…Ù„",
                position: "Ø§Ù„Ù…Ù†ØµØ¨",
                department: "Ø§Ù„Ù‚Ø³Ù…",
                salary: "Ø§Ù„Ø±Ø§ØªØ¨",
                phone: "Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ",
                hireDate: "ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙˆØ¸ÙŠÙ",
                addWorker: "Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ø§Ù…Ù„",
                operator: "Ù…Ø´ØºÙ„",
                technician: "ÙÙ†ÙŠ",
                supervisor: "Ù…Ø´Ø±Ù",
                manager: "Ù…Ø¯ÙŠØ±",
                maintenanceWorker: "Ø¹Ø§Ù…Ù„ ØµÙŠØ§Ù†Ø©",
                security: "Ø£Ù…Ù†",
                driver: "Ø³Ø§Ø¦Ù‚",
                cleaner: "Ø¹Ø§Ù…Ù„ Ù†Ø¸Ø§ÙØ©",
                production: "Ø§Ù„Ø¥Ù†ØªØ§Ø¬",
                quality: "Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø¬ÙˆØ¯Ø©",
                maintenanceDept: "Ø§Ù„ØµÙŠØ§Ù†Ø©",
                warehouse: "Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹",
                administrationDept: "Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©",
                salesDept: "Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª",
                securityDept: "Ø§Ù„Ø£Ù…Ù†",
                
                // Activities
                activitiesManagement: "Ø¥Ø¯Ø§Ø±Ø© Ø³Ø¬Ù„ Ø§Ù„Ø£Ù†Ø´Ø·Ø©",
                addNewActivity: "Ø¥Ø¶Ø§ÙØ© Ù†Ø´Ø§Ø· Ø¬Ø¯ÙŠØ¯",
                activitiesList: "Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ù†Ø´Ø·Ø©",
                activityTitle: "Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù†Ø´Ø§Ø·",
                activityDescription: "ÙˆØµÙ Ø§Ù„Ù†Ø´Ø§Ø·",
                activityDate: "ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ø´Ø§Ø·",
                addActivity: "Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ø´Ø§Ø·",
                
                // Reports
                reportsAnalytics: "Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª",
                monthlyIncome: "Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©",
                monthlyExpenses: "Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©",
                monthlyProfit: "Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø´Ù‡Ø±ÙŠ",
                storageItems: "Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø®Ø²ÙˆÙ†",
                financialChart: "Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ø§Ù„Ù…Ø§Ù„ÙŠ",
                exportData: "ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",
                exportSales: "ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª",
                exportExpenses: "ØªØµØ¯ÙŠØ± Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª",
                exportStorage: "ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ø®Ø²ÙˆÙ†",
                exportWorkers: "ØªØµØ¯ÙŠØ± Ø§Ù„Ø¹Ù…Ø§Ù„",
                
                // Common
                actions: "Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª",
                edit: "ØªØ¹Ø¯ÙŠÙ„",
                delete: "Ø­Ø°Ù",
                cancel: "Ø¥Ù„ØºØ§Ø¡",
                save: "Ø­ÙØ¸",
                close: "Ø¥ØºÙ„Ø§Ù‚",
                loading: "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...",
                success: "ØªÙ… Ø¨Ù†Ø¬Ø§Ø­!",
                error: "Ø­Ø¯Ø« Ø®Ø·Ø£!",
                confirm: "ØªØ£ÙƒÙŠØ¯",
                confirmDelete: "Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°ÙØŸ",
                egp: "Ø¬.Ù…"
            },
            en: {
                // Company info
                companyName: "Al-Wasiloon Factory",
                factorySubtitle: "For Mining & Chemical Industries",
                managementSystem: "Management System",
                
                // Navigation
                home: "Home",
                sales: "Sales",
                storage: "Storage",
                expenses: "Expenses",
                workers: "Workers",
                activities: "Activity Log",
                reports: "Reports",
                
                // Home page
                welcomeTitle: "Welcome to Al-Wasiloon Factory Management System",
                welcomeSubtitle: "Comprehensive system for financial and production operations management",
                quickSale: "Quick Sale",
                checkStorage: "Check Storage",
                viewReports: "View Reports",
                totalIncome: "Total Income",
                totalExpenses: "Total Expenses",
                netProfit: "Net Profit",
                totalWorkers: "Total Workers",
                recentActivities: "Recent Activities",
                noActivities: "No recent activities",
                activitiesDescription: "Latest operations and activities will appear here",
                
                // Sales
                salesManagement: "Sales Management",
                addNewSale: "Add New Sale",
                salesList: "Sales List",
                productName: "Product Name",
                quantity: "Quantity",
                totalAmount: "Total Amount",
                saleDate: "Sale Date",
                clientName: "Client Name",
                clientContact: "Contact Info",
                addSale: "Add Sale",
                editSale: "Edit Sale",
                updateSale: "Update Sale",
                
                // Storage
                storageManagement: "Storage Management",
                addStorageItem: "Add Storage Item",
                storageList: "Storage List",
                itemName: "Item Name",
                itemType: "Item Type",
                unit: "Unit",
                minLevel: "Min Level",
                status: "Status",
                addItem: "Add Item",
                rawMaterial: "Raw Material",
                finishedProduct: "Finished Product",
                packaging: "Packaging",
                equipment: "Equipment",
                kg: "Kilogram",
                ton: "Ton",
                piece: "Piece",
                liter: "Liter",
                bag: "Bag",
                inStock: "In Stock",
                lowStock: "Low Stock",
                outOfStock: "Out of Stock",
                
                // Expenses
                expensesManagement: "Expenses Management",
                addNewExpense: "Add New Expense",
                expensesList: "Expenses List",
                expenseName: "Expense Name",
                amount: "Amount",
                category: "Category",
                expenseDate: "Expense Date",
                addExpense: "Add Expense",
                operations: "Operations",
                utilities: "Utilities",
                maintenance: "Maintenance",
                salaries: "Salaries",
                materials: "Materials",
                transport: "Transport",
                administrative: "Administrative",
                other: "Other",
                
                // Workers
                workersManagement: "Workers Management",
                addNewWorker: "Add New Worker",
                workersList: "Workers List",
                workerName: "Worker Name",
                position: "Position",
                department: "Department",
                salary: "Salary",
                phone: "Phone",
                hireDate: "Hire Date",
                addWorker: "Add Worker",
                operator: "Operator",
                technician: "Technician",
                supervisor: "Supervisor",
                manager: "Manager",
                maintenanceWorker: "Maintenance Worker",
                security: "Security",
                driver: "Driver",
                cleaner: "Cleaner",
                production: "Production",
                quality: "Quality Control",
                maintenanceDept: "Maintenance",
                warehouse: "Warehouse",
                administrationDept: "Administration",
                salesDept: "Sales",
                securityDept: "Security",
                
                // Activities
                activitiesManagement: "Activity Log Management",
                addNewActivity: "Add New Activity",
                activitiesList: "Activities List",
                activityTitle: "Activity Title",
                activityDescription: "Activity Description",
                activityDate: "Activity Date",
                addActivity: "Add Activity",
                
                // Reports
                reportsAnalytics: "Reports & Analytics",
                monthlyIncome: "Monthly Income",
                monthlyExpenses: "Monthly Expenses",
                monthlyProfit: "Monthly Profit",
                storageItems: "Storage Items",
                financialChart: "Financial Chart",
                exportData: "Export Data",
                exportSales: "Export Sales",
                exportExpenses: "Export Expenses",
                exportStorage: "Export Storage",
                exportWorkers: "Export Workers",
                
                // Common
                actions: "Actions",
                edit: "Edit",
                delete: "Delete",
                cancel: "Cancel",
                save: "Save",
                close: "Close",
                loading: "Loading...",
                success: "Success!",
                error: "Error!",
                confirm: "Confirm",
                confirmDelete: "Are you sure you want to delete?",
                egp: "EGP"
            }
        };

        // Utility Functions
        function formatCurrency(amount) {
            return new Intl.NumberFormat('ar-EG', {
                style: 'currency',
                currency: 'EGP',
                minimumFractionDigits: 0
            }).format(amount);
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString(currentLanguage === 'ar' ? 'ar-EG' : 'en-US');
        }

        function getCurrentDate() {
            return new Date().toISOString().split('T')[0];
        }

        function generateId(array) {
            return Math.max(...array.map(item => item.id), 0) + 1;
        }

        function saveData() {
            localStorage.setItem('fertilizerFactoryData', JSON.stringify(data));
        }

        function showSuccessMessage(message) {
            const successMsg = document.getElementById('success-message');
            const successText = document.getElementById('success-text');
            successText.textContent = message;
            successMsg.classList.add('show');
            setTimeout(() => {
                successMsg.classList.remove('show');
            }, 3000);
        }

        // Language switching
        function switchLanguage(lang) {
            currentLanguage = lang;
            const html = document.documentElement;
            const body = document.body;
            
            if (lang === 'en') {
                html.lang = 'en';
                html.dir = 'ltr';
                body.classList.add('ltr');
                document.getElementById('lang-en').classList.add('active');
                document.getElementById('lang-ar').classList.remove('active');
            } else {
                html.lang = 'ar';
                html.dir = 'rtl';
                body.classList.remove('ltr');
                document.getElementById('lang-ar').classList.add('active');
                document.getElementById('lang-en').classList.remove('active');
            }
            
            updateTranslations();
            updateCurrentTime();
            
            // Update charts if they exist
            if (charts.financial) {
                initFinancialChart();
            }
        }

        function updateTranslations() {
            const elements = document.querySelectorAll('[data-key]');
            elements.forEach(element => {
                const key = element.getAttribute('data-key');
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    element.textContent = translations[currentLanguage][key];
                }
            });
            
            // Update select options
            const selectOptions = document.querySelectorAll('select option[data-key]');
            selectOptions.forEach(option => {
                const key = option.getAttribute('data-key');
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    option.textContent = translations[currentLanguage][key];
                }
            });
        }

        // Page navigation
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Remove active class from all nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Show selected page
            document.getElementById(pageId).classList.add('active');
            
            // Add active class to corresponding nav item
            document.querySelector(`[data-page="${pageId}"]`).classList.add('active');
            
            // Initialize page-specific functionality
            initializePage(pageId);
        }

        function initializePage(pageId) {
            switch(pageId) {
                case 'home':
                    initDashboard();
                    break;
                case 'sales':
                    initSales();
                    break;
                case 'storage':
                    initStorage();
                    break;
                case 'expenses':
                    initExpenses();
                    break;
                case 'workers':
                    initWorkers();
                    break;
                case 'activities':
                    initActivityLogs();
                    break;
                case 'reports':
                    initReports();
                    break;
            }
        }

        // Dashboard initialization
        function initDashboard() {
            updateFinancialSummary();
            
            // Set today's date as default
            const dateInputs = document.querySelectorAll('input[type="date"]');
            dateInputs.forEach(input => {
                if (!input.value) {
                    input.value = getCurrentDate();
                }
            });
        }

        function updateFinancialSummary() {
            const totalIncome = data.sales.reduce((sum, sale) => sum + sale.totalAmount, 0);
            const totalExpenses = data.expenses.reduce((sum, expense) => sum + expense.amount, 0);
            const netProfit = totalIncome - totalExpenses;
            const totalWorkers = data.workers.length;
            
            document.getElementById('total-income').textContent = formatCurrency(totalIncome);
            document.getElementById('total-expenses').textContent = formatCurrency(totalExpenses);
            document.getElementById('net-profit').textContent = formatCurrency(netProfit);
            document.getElementById('total-workers').textContent = totalWorkers;
        }

        // Sales Management
        function initSales() {
            updateSalesProductOptions();
            updateSalesTable();
            
            // Set today's date as default
            document.getElementById('sale-date').value = getCurrentDate();
            
            // Setup form submission
            const salesForm = document.getElementById('sales-form');
            salesForm.onsubmit = addSale;
            
            // Setup edit form submission
            const editSalesForm = document.getElementById('edit-sale-form');
            editSalesForm.onsubmit = updateSale;
        }

        function updateSalesProductOptions() {
            // This function would typically populate product options from storage
            // For now, it's a placeholder for future enhancement
        }

        function updateSalesTable() {
            const tableBody = document.getElementById('sales-table');
            tableBody.innerHTML = '';
            
            data.sales.forEach(sale => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${sale.productName}</td>
                    <td>${sale.quantity}</td>
                    <td>${formatCurrency(sale.totalAmount)}</td>
                    <td>${formatDate(sale.saleDate)}</td>
                    <td>${sale.clientName}</td>
                    <td class="action-buttons">
                        <button class="btn btn-warning" onclick="editSale(${sale.id})">
                            ${translations[currentLanguage].edit}
                        </button>
                        <button class="btn btn-danger" onclick="deleteSale(${sale.id})">
                            ${translations[currentLanguage].delete}
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        function addSale(event) {
            event.preventDefault();
            
            const newSale = {
                id: generateId(data.sales),
                productName: document.getElementById('sale-product').value,
                quantity: parseInt(document.getElementById('sale-quantity').value),
                totalAmount: parseFloat(document.getElementById('sale-amount').value),
                saleDate: new Date(document.getElementById('sale-date').value),
                clientName: document.getElementById('sale-client').value,
                clientContact: document.getElementById('sale-contact').value,
                createdAt: new Date()
            };
            
            data.sales.push(newSale);
            saveData();
            updateSalesTable();
            updateFinancialSummary();
            
            // Reset form
            document.getElementById('sales-form').reset();
            document.getElementById('sale-date').value = getCurrentDate();
            
            showSuccessMessage(translations[currentLanguage].success);
        }

        function editSale(id) {
            const sale = data.sales.find(s => s.id === id);
            if (!sale) return;
            
            editingId = id;
            
            // Populate edit form
            document.getElementById('edit-sale-product').value = sale.productName;
            document.getElementById('edit-sale-quantity').value = sale.quantity;
            document.getElementById('edit-sale-amount').value = sale.totalAmount;
            document.getElementById('edit-sale-date').value = sale.saleDate.toISOString().split('T')[0];
            document.getElementById('edit-sale-client').value = sale.clientName;
            document.getElementById('edit-sale-contact').value = sale.clientContact || '';
            
            // Show modal
            showModal('edit-sale-modal');
        }

        function updateSale(event) {
            event.preventDefault();
            
            const saleIndex = data.sales.findIndex(s => s.id === editingId);
            if (saleIndex === -1) return;
            
            data.sales[saleIndex] = {
                ...data.sales[saleIndex],
                productName: document.getElementById('edit-sale-product').value,
                quantity: parseInt(document.getElementById('edit-sale-quantity').value),
                totalAmount: parseFloat(document.getElementById('edit-sale-amount').value),
                saleDate: new Date(document.getElementById('edit-sale-date').value),
                clientName: document.getElementById('edit-sale-client').value,
                clientContact: document.getElementById('edit-sale-contact').value
            };
            
            saveData();
            updateSalesTable();
            updateFinancialSummary();
            closeModal('edit-sale-modal');
            
            showSuccessMessage(translations[currentLanguage].success);
        }

        function deleteSale(id) {
            if (confirm(translations[currentLanguage].confirmDelete)) {
                data.sales = data.sales.filter(sale => sale.id !== id);
                saveData();
                updateSalesTable();
                updateFinancialSummary();
                showSuccessMessage(translations[currentLanguage].success);
            }
        }

        // Storage Management
        function initStorage() {
            updateStorageTable();
            
            // Setup form submission
            const storageForm = document.getElementById('storage-form');
            storageForm.onsubmit = addStorageItem;
        }

        function updateStorageTable() {
            const tableBody = document.getElementById('storage-table');
            tableBody.innerHTML = '';
            
            data.storageItems.forEach(item => {
                const status = item.quantity <= item.minLevel ? 
                    (item.quantity === 0 ? 'outOfStock' : 'lowStock') : 'inStock';
                
                const statusClass = status === 'outOfStock' ? 'btn-danger' : 
                                   status === 'lowStock' ? 'btn-warning' : 'btn-secondary';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.itemName}</td>
                    <td>${translations[currentLanguage][item.itemType]}</td>
                    <td>${item.quantity}</td>
                    <td>${translations[currentLanguage][item.unit]}</td>
                    <td>${item.minLevel}</td>
                    <td>
                        <span class="btn ${statusClass}" style="font-size: 12px; padding: 4px 8px;">
                            ${translations[currentLanguage][status]}
                        </span>
                    </td>
                    <td class="action-buttons">
                        <button class="btn btn-danger" onclick="deleteStorageItem(${item.id})">
                            ${translations[currentLanguage].delete}
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        function addStorageItem(event) {
            event.preventDefault();
            
            const newItem = {
                id: generateId(data.storageItems),
                itemName: document.getElementById('storage-item').value,
                itemType: document.getElementById('storage-type').value,
                quantity: parseInt(document.getElementById('storage-quantity').value),
                unit: document.getElementById('storage-unit').value,
                minLevel: parseInt(document.getElementById('storage-min').value),
                createdAt: new Date()
            };
            
            data.storageItems.push(newItem);
            saveData();
            updateStorageTable();
            
            // Reset form
            document.getElementById('storage-form').reset();
            
            showSuccessMessage(translations[currentLanguage].success);
        }

        function deleteStorageItem(id) {
            if (confirm(translations[currentLanguage].confirmDelete)) {
                data.storageItems = data.storageItems.filter(item => item.id !== id);
                saveData();
                updateStorageTable();
                showSuccessMessage(translations[currentLanguage].success);
            }
        }

        function getItemTypeLabel(type) {
            return translations[currentLanguage][type] || type;
        }

        function getUnitLabel(unit) {
            return translations[currentLanguage][unit] || unit;
        }

        // Expenses Management
        function initExpenses() {
            updateExpensesTable();
            
            // Set today's date as default
            document.getElementById('expense-date').value = getCurrentDate();
            
            // Setup form submission
            const expensesForm = document.getElementById('expenses-form');
            expensesForm.onsubmit = addExpense;
        }

        function updateExpensesTable() {
            const tableBody = document.getElementById('expenses-table');
            tableBody.innerHTML = '';
            
            data.expenses.forEach(expense => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${expense.name}</td>
                    <td>${formatCurrency(expense.amount)}</td>
                    <td>${translations[currentLanguage][expense.category]}</td>
                    <td>${formatDate(expense.expenseDate)}</td>
                    <td class="action-buttons">
                        <button class="btn btn-danger" onclick="deleteExpense(${expense.id})">
                            ${translations[currentLanguage].delete}
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        function addExpense(event) {
            event.preventDefault();
            
            const newExpense = {
                id: generateId(data.expenses),
                name: document.getElementById('expense-name').value,
                amount: parseFloat(document.getElementById('expense-amount').value),
                category: document.getElementById('expense-category').value,
                expenseDate: new Date(document.getElementById('expense-date').value),
                createdAt: new Date()
            };
            
            data.expenses.push(newExpense);
            saveData();
            updateExpensesTable();
            updateFinancialSummary();
            
            // Reset form
            document.getElementById('expenses-form').reset();
            document.getElementById('expense-date').value = getCurrentDate();
            
            showSuccessMessage(translations[currentLanguage].success);
        }

        function deleteExpense(id) {
            if (confirm(translations[currentLanguage].confirmDelete)) {
                data.expenses = data.expenses.filter(expense => expense.id !== id);
                saveData();
                updateExpensesTable();
                updateFinancialSummary();
                showSuccessMessage(translations[currentLanguage].success);
            }
        }

        function getCategoryLabel(category) {
            return translations[currentLanguage][category] || category;
        }

        // Workers Management
        function initWorkers() {
            updateWorkersTable();
            
            // Set today's date as default
            document.getElementById('worker-hire-date').value = getCurrentDate();
            
            // Setup form submission
            const workersForm = document.getElementById('workers-form');
            workersForm.onsubmit = addWorker;
        }

        function updateWorkersTable() {
            const tableBody = document.getElementById('workers-table');
            tableBody.innerHTML = '';
            
            data.workers.forEach(worker => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${worker.name}</td>
                    <td>${translations[currentLanguage][worker.position]}</td>
                    <td>${translations[currentLanguage][worker.department]}</td>
                    <td>${formatCurrency(worker.salary)}</td>
                    <td>${worker.phone}</td>
                    <td>${formatDate(worker.hireDate)}</td>
                    <td class="action-buttons">
                        <button class="btn btn-danger" onclick="deleteWorker(${worker.id})">
                            ${translations[currentLanguage].delete}
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        function addWorker(event) {
            event.preventDefault();
            
            const newWorker = {
                id: generateId(data.workers),
                name: document.getElementById('worker-name').value,
                position: document.getElementById('worker-position').value,
                department: document.getElementById('worker-department').value,
                salary: parseFloat(document.getElementById('worker-salary').value),
                phone: document.getElementById('worker-phone').value,
                hireDate: new Date(document.getElementById('worker-hire-date').value),
                createdAt: new Date()
            };
            
            data.workers.push(newWorker);
            saveData();
            updateWorkersTable();
            updateFinancialSummary();
            
            // Reset form
            document.getElementById('workers-form').reset();
            document.getElementById('worker-hire-date').value = getCurrentDate();
            
            showSuccessMessage(translations[currentLanguage].success);
        }

        function deleteWorker(id) {
            if (confirm(translations[currentLanguage].confirmDelete)) {
                data.workers = data.workers.filter(worker => worker.id !== id);
                saveData();
                updateWorkersTable();
                updateFinancialSummary();
                showSuccessMessage(translations[currentLanguage].success);
            }
        }

        function getPositionLabel(position) {
            return translations[currentLanguage][position] || position;
        }

        function getDepartmentLabel(department) {
            return translations[currentLanguage][department] || department;
        }

        // Activity Logs Management
        function initActivityLogs() {
            updateActivitiesTable();
            
            // Set today's date as default
            document.getElementById('activity-date').value = getCurrentDate();
            
            // Setup form submission
            const activitiesForm = document.getElementById('activities-form');
            activitiesForm.onsubmit = addActivity;
        }

        function updateActivitiesTable() {
            const tableBody = document.getElementById('activities-table');
            tableBody.innerHTML = '';
            
            data.activityLogs.forEach(activity => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${activity.title}</td>
                    <td>${activity.description}</td>
                    <td>${formatDate(activity.logDate)}</td>
                    <td class="action-buttons">
                        <button class="btn btn-danger" onclick="deleteActivity(${activity.id})">
                            ${translations[currentLanguage].delete}
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        function addActivity(event) {
            event.preventDefault();
            
            const newActivity = {
                id: generateId(data.activityLogs),
                title: document.getElementById('activity-title').value,
                description: document.getElementById('activity-description').value,
                logDate: new Date(document.getElementById('activity-date').value),
                createdAt: new Date()
            };
            
            data.activityLogs.push(newActivity);
            saveData();
            updateActivitiesTable();
            
            // Reset form
            document.getElementById('activities-form').reset();
            document.getElementById('activity-date').value = getCurrentDate();
            
            showSuccessMessage(translations[currentLanguage].success);
        }

        function deleteActivity(id) {
            if (confirm(translations[currentLanguage].confirmDelete)) {
                data.activityLogs = data.activityLogs.filter(activity => activity.id !== id);
                saveData();
                updateActivitiesTable();
                showSuccessMessage(translations[currentLanguage].success);
            }
        }

        function getActivityTypeLabel(type) {
            return translations[currentLanguage][type] || type;
        }

        // Reports and Analytics
        function initReports() {
            updateReportsData();
            initFinancialChart();
        }

        function updateReportsData() {
            const totalIncome = data.sales.reduce((sum, sale) => sum + sale.totalAmount, 0);
            const totalExpenses = data.expenses.reduce((sum, expense) => sum + expense.amount, 0);
            const netProfit = totalIncome - totalExpenses;
            const storageItemsCount = data.storageItems.length;
            
            document.getElementById('report-income').textContent = formatCurrency(totalIncome);
            document.getElementById('report-expenses').textContent = formatCurrency(totalExpenses);
            document.getElementById('report-profit').textContent = formatCurrency(netProfit);
            document.getElementById('report-storage-items').textContent = storageItemsCount;
        }

        function initFinancialChart() {
            const ctx = document.getElementById('financial-chart');
            if (!ctx) return;
            
            // Destroy existing chart if it exists
            if (charts.financial) {
                charts.financial.destroy();
            }
            
            const totalIncome = data.sales.reduce((sum, sale) => sum + sale.totalAmount, 0);
            const totalExpenses = data.expenses.reduce((sum, expense) => sum + expense.amount, 0);
            
            charts.financial = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: [
                        translations[currentLanguage].totalIncome,
                        translations[currentLanguage].totalExpenses,
                        translations[currentLanguage].netProfit
                    ],
                    datasets: [{
                        label: translations[currentLanguage].egp,
                        data: [totalIncome, totalExpenses, totalIncome - totalExpenses],
                        backgroundColor: [
                            'rgba(34, 197, 94, 0.8)',
                            'rgba(239, 68, 68, 0.8)',
                            'rgba(59, 130, 246, 0.8)'
                        ],
                        borderColor: [
                            'rgba(34, 197, 94, 1)',
                            'rgba(239, 68, 68, 1)',
                            'rgba(59, 130, 246, 1)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return formatCurrency(value);
                                }
                            }
                        }
                    }
                }
            });
        }

        function generateInventoryReport() {
            const lowStockItems = data.storageItems.filter(item => item.quantity <= item.minLevel);
            console.log('Low stock items:', lowStockItems);
            showSuccessMessage('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø®Ø²ÙˆÙ†');
        }

        // Data Export Functions
        function exportData(type) {
            let dataToExport = [];
            let filename = '';
            
            switch(type) {
                case 'sales':
                    dataToExport = data.sales;
                    filename = 'sales_export.json';
                    break;
                case 'expenses':
                    dataToExport = data.expenses;
                    filename = 'expenses_export.json';
                    break;
                case 'storage':
                    dataToExport = data.storageItems;
                    filename = 'storage_export.json';
                    break;
                case 'workers':
                    dataToExport = data.workers;
                    filename = 'workers_export.json';
                    break;
                default:
                    return;
            }
            
            const jsonData = JSON.stringify(dataToExport, null, 2);
            const blob = new Blob([jsonData], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showSuccessMessage(translations[currentLanguage].success);
        }

        function backupData() {
            const backup = {
                timestamp: new Date().toISOString(),
                data: data
            };
            
            const jsonData = JSON.stringify(backup, null, 2);
            const blob = new Blob([jsonData], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = 'factory_backup.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showSuccessMessage('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©');
        }

        function clearAllData() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.')) {
                localStorage.removeItem('fertilizerFactoryData');
                location.reload();
            }
        }

        // Modal Functions
        function showModal(modalId) {
            document.getElementById(modalId).classList.remove('hidden');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
            editingId = null;
        }

        // Time Functions
        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString(currentLanguage === 'ar' ? 'ar-EG' : 'en-US');
            const timeElements = document.querySelectorAll('.current-time');
            timeElements.forEach(element => {
                element.textContent = timeString;
            });
        }

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved data
            const savedData = localStorage.getItem('fertilizerFactoryData');
            if (savedData) {
                const parsedData = JSON.parse(savedData);
                Object.assign(data, parsedData);
                
                // Convert date strings back to Date objects
                data.sales.forEach(sale => {
                    sale.saleDate = new Date(sale.saleDate);
                    sale.createdAt = new Date(sale.createdAt);
                });
                data.expenses.forEach(expense => {
                    expense.expenseDate = new Date(expense.expenseDate);
                    expense.createdAt = new Date(expense.createdAt);
                });
                data.workers.forEach(worker => {
                    worker.hireDate = new Date(worker.hireDate);
                    worker.createdAt = new Date(worker.createdAt);
                });
                data.storageItems.forEach(item => {
                    item.createdAt = new Date(item.createdAt);
                });
                data.activityLogs.forEach(log => {
                    log.logDate = new Date(log.logDate);
                    log.createdAt = new Date(log.createdAt);
                });
            }
            
            // Initialize translations
            updateTranslations();
            
            // Initialize dashboard
            initDashboard();
            
            // Update time every second
            setInterval(updateCurrentTime, 1000);
            updateCurrentTime();
            
            // Add click event listeners for modal close
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('modal')) {
                    const modalId = e.target.id;
                    closeModal(modalId);
                }
            });
        });
    </script>
</body>
</html>